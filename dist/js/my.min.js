var o="object"==typeof o?o:{};(o={init:function(){mapboxgl.accessToken="pk.eyJ1IjoidGhhdGJyYW0iLCJhIjoiY2p0YzM1NW9zMHM5MTN5cDRsdnJoOGw3byJ9.A7umZVt9Sx7Nb8jfN6M03g";let e=$.urlParam("mydocid");if(console.log("mydoc_id_queryStr_val: "+e),!1===e){o.loadMap().on("load",function(){$("#mydoc_map_status").hide(),$("#mydoc_map .alert").is(":visible")&&$("#mydoc_map .alert").removeAttr("style")})}else $("#mydoc_id_search_field").val(e),$("#mydoc_id_search_go").prop("disabled",!0),o.findMyDoC("url");$("#mydoc_id_search_field").on("input",function(){let e=$(this).val();(e=$.trim(e)).length>4?($("#mydoc_id_search_go").prop("disabled",!1),$("#mydoc_id_search_field").off("keypress"),$("#mydoc_id_search_field").keypress(function(e){13===e.which&&o.findMyDoC("user")})):($("#mydoc_id_search_go").prop("disabled",!0),$("#mydoc_id_search_field").off("keypress"))}),$("#mydoc_id_search_go").click(function(){o.findMyDoC("user")})},loadMap:function(o){$("#mydoc_map_status").show();var e=[-105.547222,39],t=6.5;return void 0!==o&&(void 0!==o.center&&(e=o.center),void 0!==o.zoom&&(t=o.zoom)),new mapboxgl.Map({container:"mydoc_map",style:"mapbox://styles/thatbram/cjtokh26902ad1fm43xqm4kv2",center:e,zoom:t})},findMyDoC:function(e){let t;switch($("#mydoc_map .alert").alert("close"),e){case"user":console.log("source: user"),-1!==location.href.indexOf("?")&&history.pushState("",document.title,window.location.pathname),t=$("#mydoc_id_search_field").val(),t=$.trim(t);break;case"url":console.log("source: url");let o=$.urlParam("mydocid");t=o}t=t.toLowerCase(),$.ajax({url:"/.netlify/functions/mydoc_at?mydocid="+t,dataType:"json"}).done(function(e){if(console.log("resp: "),console.log(e),e.length>0){$("#mydoc_details").css("visibility","visible");let n=t;var i=e[0].fields;if(console.log(i),history.pushState("",document.title,"?mydocid="+n),i.videos){var a=i.videos;a=a.split(","),$.each(a,function(o,e){let t=e.substr(0,e.indexOf(":"));var i,a=e.substr(e.indexOf(":")+1,e.length);switch(t){case"vimeo":i='<iframe src="https://player.vimeo.com/video/'+a+'" class="video" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe>'}$("#mydoc_details_videos_container").append(i)})}else $("#mydoc_details_videos_container").html("");if(console.log("mydoc_data.photos: "),console.log(i.photos),i.photos){var s=i.photos;s=s.split(","),$("#mydoc_details_photos_container").css("visibility","visible")}else $("#mydoc_details_photos_container").css("visibility","hidden");if(i.collection_date)i.collection_date;if(i.latitude)var d=i.latitude;if(i.longitude)var l=i.longitude;if(!i.latitude||!i.longitude)return void c("missingCoors");let r=[l,d],m={center:r,zoom:15},p=o.loadMap(m);p.on("load",function(){$("#mydoc_map_status").hide(),$("#mydoc_map .alert").is(":visible")&&$("#mydoc_map .alert").removeAttr("style");(new mapboxgl.Marker).setLngLat(r).addTo(p);var o={top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38],"bottom-left":[10,-40],"bottom-right":[-10,-40],left:[8,-30],right:[-8,-30]};mydoc_map_popup_template='<span class="mydoc_id">'+n+"</span><br>"+(d+", "+l),mydoc_map_popup=new mapboxgl.Popup({offset:o,className:"mydoc-map-popup"}).setLngLat([l,d]).setHTML(mydoc_map_popup_template).addTo(p)})}else c("invalidMydoc");function c(e){var t;switch(e){case"invalidMydoc":$("#mydoc_details, #mydoc_details > section").css("visibility","hidden"),t="<strong>DoC id not found.</strong> Please try again.";break;case"missingCoors":t="<strong>Can't map this Dose ID.</strong> Seems to be from lack of coordinates. Sorry about that... =/";break;default:t="<strong>Can't map this Dose ID.</strong> Looks like that's all the info there is. Sorry about that... =/"}if(o.loadMap().on("load",function(){console.log("findMyDoC mydoc_map.on(load) - invalid id"),$("#mydoc_map_status").hide(),$("#mydoc_map .alert").is(":visible")&&$("#mydoc_map .alert").removeAttr("style")}),$("#mydoc_map").append('<div class="alert alert-danger alert-dismissible fade show" role="alert">'+t+'<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'),console.log("$(#mydoc_map_status).is(:visible): "+$("#mydoc_map_status").is(":visible")),$("#mydoc_map_status").is(":visible")){let o=$("#mydoc_map_status").outerHeight();$("#mydoc_map .alert:first").css("margin-top",o+16+"px")}}})}}).init();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm15LmpzIl0sIm5hbWVzIjpbIm15ZG9jIiwiaW5pdCIsIm1hcGJveGdsIiwiYWNjZXNzVG9rZW4iLCJteWRvY19pZF9xdWVyeVN0cl92YWwiLCIkIiwidXJsUGFyYW0iLCJjb25zb2xlIiwibG9nIiwibG9hZE1hcCIsIm9uIiwiaGlkZSIsImlzIiwicmVtb3ZlQXR0ciIsInZhbCIsInByb3AiLCJmaW5kTXlEb0MiLCJteWRvY19pZF9zZWFyY2hfdmFsIiwidGhpcyIsInRyaW0iLCJsZW5ndGgiLCJvZmYiLCJrZXlwcmVzcyIsImUiLCJ3aGljaCIsImNsaWNrIiwic2V0dGluZ3MiLCJzaG93IiwiY2VudGVyIiwiem9vbSIsIk1hcCIsImNvbnRhaW5lciIsInN0eWxlIiwic291cmNlIiwiYWxlcnQiLCJsb2NhdGlvbiIsImhyZWYiLCJpbmRleE9mIiwiaGlzdG9yeSIsInB1c2hTdGF0ZSIsImRvY3VtZW50IiwidGl0bGUiLCJ3aW5kb3ciLCJwYXRobmFtZSIsInRvTG93ZXJDYXNlIiwiYWpheCIsInVybCIsImRhdGFUeXBlIiwiZG9uZSIsInJlc3AiLCJjc3MiLCJteWRvY19pZCIsIm15ZG9jX2RhdGEiLCJmaWVsZHMiLCJ2aWRlb3MiLCJ2aWRlb3NBcnIiLCJzcGxpdCIsImVhY2giLCJpZHgiLCJpdG0iLCJ2aWRTdmMiLCJzdWJzdHIiLCJ2aWRPYmoiLCJ2aWRJZCIsImFwcGVuZCIsImh0bWwiLCJwaG90b3MiLCJwaG90b3NBcnIiLCJjb2xsZWN0aW9uX2RhdGUiLCJsYXRpdHVkZSIsIm15ZG9jX2xhdCIsImxvbmdpdHVkZSIsIm15ZG9jX2xvbmciLCJtYXBwaW5nRXJyIiwibXlkb2NfbG9jX21iIiwibXlkb2NfbWFwIiwiTWFya2VyIiwic2V0TG5nTGF0IiwiYWRkVG8iLCJwb3B1cE9mZnNldHMiLCJ0b3AiLCJ0b3AtbGVmdCIsInRvcC1yaWdodCIsImJvdHRvbSIsImJvdHRvbS1sZWZ0IiwiYm90dG9tLXJpZ2h0IiwibGVmdCIsInJpZ2h0IiwibXlkb2NfbWFwX3BvcHVwX3RlbXBsYXRlIiwibXlkb2NfbWFwX3BvcHVwIiwiUG9wdXAiLCJvZmZzZXQiLCJjbGFzc05hbWUiLCJzZXRIVE1MIiwiY29uZGl0aW9uIiwiZXJyTXNnIiwibWFwU3RhdHVzX2giLCJvdXRlckhlaWdodCJdLCJtYXBwaW5ncyI6IkFBQ0EsSUFBSUEsRUFBNkIsaUJBQVosRUFBeUJBLEVBQVEsSUFDckRBLEVBQVEsQ0FDUkMsS0FBTyxXQUNOQyxTQUFTQyxZQUFjLDZGQUN2QixJQUFJQyxFQUF3QkMsRUFBRUMsU0FBUyxXQUl2QyxHQUZBQyxRQUFRQyxJQUFJLDBCQUE0QkosSUFFVCxJQUExQkEsRUFBa0MsQ0FDdEJKLEVBQU1TLFVBRVpDLEdBQUcsT0FBUSxXQUNwQkwsRUFBRSxxQkFBcUJNLE9BRWxCTixFQUFFLHFCQUFxQk8sR0FBRyxhQUM5QlAsRUFBRSxxQkFBcUJRLFdBQVcsZ0JBSXBDUixFQUFFLDBCQUEwQlMsSUFBSVYsR0FFaENDLEVBQUUsdUJBQXVCVSxLQUFLLFlBQVksR0FFMUNmLEVBQU1nQixVQUFVLE9BR2pCWCxFQUFFLDBCQUEwQkssR0FBRyxRQUFTLFdBQ3ZDLElBQUlPLEVBQXNCWixFQUFFYSxNQUFNSixPQUNqQ0csRUFBc0JaLEVBQUVjLEtBQUtGLElBRU5HLE9BQVMsR0FDaENmLEVBQUUsdUJBQXVCVSxLQUFLLFlBQVksR0FDMUNWLEVBQUUsMEJBQTBCZ0IsSUFBSSxZQUNoQ2hCLEVBQUUsMEJBQTBCaUIsU0FBVSxTQUFVQyxHQUMvQixLQUFaQSxFQUFFQyxPQUNMeEIsRUFBTWdCLFVBQVUsWUFJbEJYLEVBQUUsdUJBQXVCVSxLQUFLLFlBQVksR0FDMUNWLEVBQUUsMEJBQTBCZ0IsSUFBSSxlQUlsQ2hCLEVBQUUsdUJBQXVCb0IsTUFBTyxXQUMvQnpCLEVBQU1nQixVQUFVLFdBSWxCUCxRQUFVLFNBQVVpQixHQUNuQnJCLEVBQUUscUJBQXFCc0IsT0FFdkIsSUFBSUMsRUFBUyxFQUFFLFdBQVksSUFDdkJDLEVBQU8sSUFxQlgsWUFuQndCLElBQWJILFNBRXFC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UkQsSUFRaUIsSUFDaENDLEtBQVEsQ0FWTyxHQVVRLElBQ3ZCQyxNQUFTLEVBWE0sR0FXVSxLQUsxQkMseUJBQTJCLDBCQUE0QnJDLEVBQVcsZUFGOUNtQixFQUFZLEtBQU9FLEdBU3ZDaUIsZ0JBQWtCLElBQUl2RixTQUFTd0YsTUFBTSxDQUFDQyxPQUFRWixFQUFjYSxVQUFXLG9CQUNyRWYsVUFBVSxDQUFDTCxFQUFZRixJQUN2QnVCLFFBQVFMLDBCQUNSVixNQUFNSCxVQUdURixFQUFXLGdCQUdaLFNBQVNBLEVBQVlxQixHQUNwQixJQUFJQyxFQUVKLE9BQVFELEdBQ1AsSUFBSyxlQUNKekYsRUFBRSw0Q0FBNEM2QyxJQUFJLGFBQWMsVUFFaEU2QyxFQUFTLHVEQUNWLE1BQ0EsSUFBSyxlQUNKQSxFQUFTLHdHQUNWLE1BQ0EsUUFDQ0EsRUFBUywyR0FvQlgsR0FqQmdCL0YsRUFBTVMsVUFFWkMsR0FBRyxPQUFRLFdBRXBCSCxRQUFRQyxJQUFJLDZDQUVaSCxFQUFFLHFCQUFxQk0sT0FFbEJOLEVBQUUscUJBQXFCTyxHQUFHLGFBQzlCUCxFQUFFLHFCQUFxQlEsV0FBVyxXQUlwQ1IsRUFBRSxjQUFjMkQsT0FBTyw0RUFBOEUrQixFQUFTLHNJQUU5R3hGLFFBQVFDLElBQUssc0NBQXlDSCxFQUFFLHFCQUFxQk8sR0FBRyxhQUUzRVAsRUFBRSxxQkFBcUJPLEdBQUcsWUFBYyxDQUM1QyxJQUFJb0YsRUFBYzNGLEVBQUUscUJBQXFCNEYsY0FFekM1RixFQUFFLDJCQUEyQjZDLElBQUksYUFBYzhDLEVBQWMsR0FBSyxhQVVwRS9GIiwiZmlsZSI6Im15Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKiBteS5qcyAqL1xyXG52YXIgbXlkb2MgPSAoIHR5cGVvZiAobXlkb2MpID09PSAnb2JqZWN0JyApID8gbXlkb2MgOiB7fTtcclxuKG15ZG9jID0ge1xyXG5cdGluaXQgOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRtYXBib3hnbC5hY2Nlc3NUb2tlbiA9ICdway5leUoxSWpvaWRHaGhkR0p5WVcwaUxDSmhJam9pWTJwMFl6TTFOVzl6TUhNNU1UTjVjRFJzZG5Kb09HdzNieUo5LkE3dW1aVnQ5U3g3TmI4amZONk0wM2cnO1xyXG5cdFx0bGV0IG15ZG9jX2lkX3F1ZXJ5U3RyX3ZhbCA9ICQudXJsUGFyYW0oJ215ZG9jaWQnKTtcclxuXHJcblx0XHRjb25zb2xlLmxvZygnbXlkb2NfaWRfcXVlcnlTdHJfdmFsOiAnICsgbXlkb2NfaWRfcXVlcnlTdHJfdmFsKTtcclxuXHJcblx0XHRpZiAoIG15ZG9jX2lkX3F1ZXJ5U3RyX3ZhbCA9PT0gZmFsc2UgKSB7XHJcblx0XHRcdGxldCBteWRvY19tYXAgPSBteWRvYy5sb2FkTWFwKCk7XHJcblxyXG5cdFx0XHRteWRvY19tYXAub24oJ2xvYWQnLCBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0JCgnI215ZG9jX21hcF9zdGF0dXMnKS5oaWRlKCk7XHJcblxyXG5cdFx0XHRcdGlmICggJCgnI215ZG9jX21hcCAuYWxlcnQnKS5pcygnOnZpc2libGUnKSApIHtcclxuXHRcdFx0XHRcdCQoJyNteWRvY19tYXAgLmFsZXJ0JykucmVtb3ZlQXR0cignc3R5bGUnKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0JCgnI215ZG9jX2lkX3NlYXJjaF9maWVsZCcpLnZhbChteWRvY19pZF9xdWVyeVN0cl92YWwpO1xyXG5cclxuXHRcdFx0JCgnI215ZG9jX2lkX3NlYXJjaF9nbycpLnByb3AoJ2Rpc2FibGVkJywgdHJ1ZSk7XHJcblxyXG5cdFx0XHRteWRvYy5maW5kTXlEb0MoJ3VybCcpO1xyXG5cdFx0fVxyXG5cclxuXHRcdCQoJyNteWRvY19pZF9zZWFyY2hfZmllbGQnKS5vbignaW5wdXQnLCBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdGxldCBteWRvY19pZF9zZWFyY2hfdmFsID0gJCh0aGlzKS52YWwoKTtcclxuXHRcdFx0XHRteWRvY19pZF9zZWFyY2hfdmFsID0gJC50cmltKG15ZG9jX2lkX3NlYXJjaF92YWwpO1xyXG5cclxuXHRcdFx0aWYgKG15ZG9jX2lkX3NlYXJjaF92YWwubGVuZ3RoID4gNCkge1xyXG5cdFx0XHRcdCQoJyNteWRvY19pZF9zZWFyY2hfZ28nKS5wcm9wKCdkaXNhYmxlZCcsIGZhbHNlKTtcclxuXHRcdFx0XHQkKCcjbXlkb2NfaWRfc2VhcmNoX2ZpZWxkJykub2ZmKCdrZXlwcmVzcycpO1xyXG5cdFx0XHRcdCQoJyNteWRvY19pZF9zZWFyY2hfZmllbGQnKS5rZXlwcmVzcyggZnVuY3Rpb24gKGUpIHtcclxuXHRcdFx0XHRcdGlmIChlLndoaWNoID09PSAxMykge1xyXG5cdFx0XHRcdFx0XHRteWRvYy5maW5kTXlEb0MoJ3VzZXInKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQkKCcjbXlkb2NfaWRfc2VhcmNoX2dvJykucHJvcCgnZGlzYWJsZWQnLCB0cnVlKTtcclxuXHRcdFx0XHQkKCcjbXlkb2NfaWRfc2VhcmNoX2ZpZWxkJykub2ZmKCdrZXlwcmVzcycpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHJcblx0XHQkKCcjbXlkb2NfaWRfc2VhcmNoX2dvJykuY2xpY2soIGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0bXlkb2MuZmluZE15RG9DKCd1c2VyJyk7XHJcblx0XHR9KTtcclxuXHR9XHJcblx0LFxyXG5cdGxvYWRNYXAgOiBmdW5jdGlvbiAoc2V0dGluZ3MpIHtcclxuXHRcdCQoJyNteWRvY19tYXBfc3RhdHVzJykuc2hvdygpO1xyXG5cclxuXHRcdHZhciBjZW50ZXIgPSBbLTEwNS41NDcyMjIsIDM5XTtcclxuXHRcdHZhciB6b29tID0gNi41O1xyXG5cclxuXHRcdGlmICh0eXBlb2Ygc2V0dGluZ3MgIT09ICd1bmRlZmluZWQnKSB7XHJcblx0XHRcdC8qKiBJZiBubyBtYXAgY2VudGVyIGlzIHNwZWNpZmllZCwgc2V0IHRvIGdlb2dyYXBoaWMgY2VudGVyIG9mIENvbG9yYWRvICovXHJcblx0XHRcdGlmICh0eXBlb2Ygc2V0dGluZ3MuY2VudGVyICE9PSAndW5kZWZpbmVkJykge1xyXG5cdFx0XHRcdGNlbnRlciA9IHNldHRpbmdzLmNlbnRlcjtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0LyoqIElmIG5vIG1hcCB6b29tIGxldmVsIGlzIHNwZWNpZmllZCwgc2V0IHRvIGEgbGV2ZWwgbWFraW5nIENvbG9yYWRvIGlkZW50aWZpYWJsZSBhY3Jvc3Mgd2lkZXN0IHZhcmlldHkgb2YgcmVzb2x1dGlvbnMgKi9cclxuXHRcdFx0aWYgKHR5cGVvZiBzZXR0aW5ncy56b29tICE9PSAndW5kZWZpbmVkJykge1xyXG5cdFx0XHRcdHpvb20gPSBzZXR0aW5ncy56b29tO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IG15ZG9jX21hcCA9IG5ldyBtYXBib3hnbC5NYXAoe1xyXG5cdFx0XHRjb250YWluZXI6ICdteWRvY19tYXAnLFxyXG5cdFx0XHRzdHlsZTogJ21hcGJveDovL3N0eWxlcy90aGF0YnJhbS9janRva2gyNjkwMmFkMWZtNDN4cW00a3YyJywgLy8gJ1JhZG8gMlxyXG5cdFx0XHRjZW50ZXI6IGNlbnRlcixcclxuXHRcdFx0em9vbTogem9vbVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0cmV0dXJuIG15ZG9jX21hcDtcclxuXHR9XHJcblx0LFxyXG5cdGZpbmRNeURvQyA6IGZ1bmN0aW9uIChzb3VyY2UpIHtcclxuXHRcdCQoJyNteWRvY19tYXAgLmFsZXJ0JykuYWxlcnQoJ2Nsb3NlJyk7XHJcblxyXG5cdFx0bGV0IG15ZG9jX2lkX3NlYXJjaF92YWw7XHJcblxyXG5cdFx0c3dpdGNoIChzb3VyY2UpIHtcclxuXHRcdFx0Y2FzZSAndXNlcic6XHJcblxyXG5cdFx0XHRcdGNvbnNvbGUubG9nKCdzb3VyY2U6IHVzZXInKTtcclxuXHJcblx0XHRcdFx0dmFyIHFTdHJfaWR4ID0gbG9jYXRpb24uaHJlZi5pbmRleE9mKCc/Jyk7XHJcblxyXG5cdFx0XHRcdGlmIChxU3RyX2lkeCAhPT0gLTEpIHtcclxuXHRcdFx0XHRcdGhpc3RvcnkucHVzaFN0YXRlKCcnLCBkb2N1bWVudC50aXRsZSwgd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lKTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdG15ZG9jX2lkX3NlYXJjaF92YWwgPSAkKCcjbXlkb2NfaWRfc2VhcmNoX2ZpZWxkJykudmFsKCk7XHJcblx0XHRcdFx0bXlkb2NfaWRfc2VhcmNoX3ZhbCA9ICQudHJpbShteWRvY19pZF9zZWFyY2hfdmFsKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgJ3VybCc6XHJcblxyXG5cdFx0XHRcdGNvbnNvbGUubG9nKCdzb3VyY2U6IHVybCcpO1xyXG5cclxuXHRcdFx0XHRsZXQgbXlkb2NfaWRfcXVlcnlTdHJfdmFsID0gJC51cmxQYXJhbSgnbXlkb2NpZCcpO1xyXG5cdFx0XHRcdG15ZG9jX2lkX3NlYXJjaF92YWwgPSBteWRvY19pZF9xdWVyeVN0cl92YWw7XHJcblx0XHR9XHJcblxyXG5cdFx0bXlkb2NfaWRfc2VhcmNoX3ZhbCA9IG15ZG9jX2lkX3NlYXJjaF92YWwudG9Mb3dlckNhc2UoKTtcclxuXHJcblx0XHQkLmFqYXgoe1xyXG5cdFx0XHR1cmw6ICcvLm5ldGxpZnkvZnVuY3Rpb25zL215ZG9jX2F0P215ZG9jaWQ9JyArIG15ZG9jX2lkX3NlYXJjaF92YWwsXHJcblx0XHRcdGRhdGFUeXBlOiAnanNvbidcclxuXHRcdH0pLmRvbmUoIGZ1bmN0aW9uIChyZXNwKSB7XHJcblxyXG5cdFx0XHRjb25zb2xlLmxvZygncmVzcDogJyk7XHJcblx0XHRcdGNvbnNvbGUubG9nKHJlc3ApO1xyXG5cclxuXHRcdFx0aWYgKHJlc3AubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdCQoJyNteWRvY19kZXRhaWxzJykuY3NzKCd2aXNpYmlsaXR5JywgJ3Zpc2libGUnKTtcclxuXHJcblx0XHRcdFx0bGV0IG15ZG9jX2lkID0gbXlkb2NfaWRfc2VhcmNoX3ZhbDtcclxuXHRcdFx0XHR2YXIgbXlkb2NfZGF0YSA9IHJlc3BbMF0uZmllbGRzO1xyXG5cclxuXHRcdFx0XHRjb25zb2xlLmxvZyhteWRvY19kYXRhKTtcclxuXHJcblx0XHRcdFx0LyoqIFNldCBkaXJlY3RseSBhY2Nlc3NpYmxlIFVSTCAqL1xyXG5cdFx0XHRcdGhpc3RvcnkucHVzaFN0YXRlKCcnLCBkb2N1bWVudC50aXRsZSwgJz9teWRvY2lkPScgKyBteWRvY19pZCk7XHJcblxyXG5cdFx0XHRcdGlmIChteWRvY19kYXRhLnZpZGVvcykge1xyXG5cdFx0XHRcdFx0dmFyIHZpZGVvc0FyciA9IG15ZG9jX2RhdGEudmlkZW9zO1xyXG5cdFx0XHRcdFx0XHR2aWRlb3NBcnIgPSB2aWRlb3NBcnIuc3BsaXQoJywnKTtcclxuXHJcblx0XHRcdFx0XHQkLmVhY2godmlkZW9zQXJyLCBmdW5jdGlvbiAoaWR4LCBpdG0pIHtcclxuXHRcdFx0XHRcdFx0bGV0IHZpZFN2YyA9IGl0bS5zdWJzdHIoMCwgaXRtLmluZGV4T2YoJzonKSk7XHJcblx0XHRcdFx0XHRcdHZhciB2aWRJZCA9IGl0bS5zdWJzdHIoaXRtLmluZGV4T2YoJzonKSsxLCBpdG0ubGVuZ3RoKTtcclxuXHRcdFx0XHRcdFx0dmFyIHZpZE9iajtcclxuXHJcblx0XHRcdFx0XHRcdHN3aXRjaCAodmlkU3ZjKSB7XHJcblx0XHRcdFx0XHRcdFx0Y2FzZSAndmltZW8nOlxyXG5cdFx0XHRcdFx0XHRcdFx0dmlkT2JqID0gJzxpZnJhbWUgc3JjPVwiaHR0cHM6Ly9wbGF5ZXIudmltZW8uY29tL3ZpZGVvLycgKyB2aWRJZCArICdcIiBjbGFzcz1cInZpZGVvXCIgZnJhbWVib3JkZXI9XCIwXCIgYWxsb3c9XCJhdXRvcGxheTsgZnVsbHNjcmVlblwiIGFsbG93ZnVsbHNjcmVlbj48L2lmcmFtZT4nO1xyXG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdC8vIGNhc2UgJ3lvdXR1YmUnOlxyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gdmlkT2JqID0gJyc7IC8vICdodHRwczovL3lvdXR1YmUuY29tL3dhdGNoP3Y9JyArIHZpZElkO1xyXG5cdFx0XHRcdFx0XHRcdC8vIGJyZWFrO1xyXG5cdFx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0XHQkKCcjbXlkb2NfZGV0YWlsc192aWRlb3NfY29udGFpbmVyJykuYXBwZW5kKHZpZE9iaik7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0JCgnI215ZG9jX2RldGFpbHNfdmlkZW9zX2NvbnRhaW5lcicpLmh0bWwoJycpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0LyoqIFxyXG5cdFx0XHRcdCAqIEZvciBpbWFnZSBkaXNwbGF5L2Nhcm91c2VsLCB1c2UgbmFtaW5nIGNvbnZlbnRpb24sIGZvciBleGFtcGxlOlxyXG5cdFx0XHRcdCAqIC0gYWxwaGEwMS5qcGcsIGFscGhhMDIuanBnXHJcblx0XHRcdFx0ICogb3JcclxuXHRcdFx0XHQgKiAtIC9hbHBoYS8wMS5qcGcsIC9hbHBoYS8wMi5qcGdcclxuXHRcdFx0XHQgKi9cclxuXHJcblx0XHRcdFx0Y29uc29sZS5sb2coJ215ZG9jX2RhdGEucGhvdG9zOiAnKTtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhteWRvY19kYXRhLnBob3Rvcyk7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0aWYgKG15ZG9jX2RhdGEucGhvdG9zKSB7XHJcblx0XHRcdFx0XHR2YXIgcGhvdG9zQXJyID0gbXlkb2NfZGF0YS5waG90b3M7XHJcblx0XHRcdFx0XHRcdHBob3Rvc0FyciA9IHBob3Rvc0Fyci5zcGxpdCgnLCcpO1xyXG5cclxuXHRcdFx0XHRcdFx0JCgnI215ZG9jX2RldGFpbHNfcGhvdG9zX2NvbnRhaW5lcicpLmNzcygndmlzaWJpbGl0eScsICd2aXNpYmxlJyk7XHJcblxyXG5cdFx0XHRcdFx0LyokLmVhY2gocGhvdG9zQXJyLCBmdW5jdGlvbiAoaWR4LCBpdG0pIHtcclxuXHRcdFx0XHRcdFx0Ly9cclxuXHRcdFx0XHRcdH0pOyovXHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdCQoJyNteWRvY19kZXRhaWxzX3Bob3Rvc19jb250YWluZXInKS5jc3MoJ3Zpc2liaWxpdHknLCAnaGlkZGVuJyk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRpZiAobXlkb2NfZGF0YS5jb2xsZWN0aW9uX2RhdGUpIHtcclxuXHRcdFx0XHRcdHZhciBteWRvY19jb2xsRGF0ZSA9IG15ZG9jX2RhdGEuY29sbGVjdGlvbl9kYXRlO1xyXG5cclxuXHRcdFx0XHRcdC8vIERvIHRoZSBkYXRlIHN0dWZmXHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRpZiAobXlkb2NfZGF0YS5sYXRpdHVkZSkge1xyXG5cdFx0XHRcdFx0dmFyIG15ZG9jX2xhdCA9IG15ZG9jX2RhdGEubGF0aXR1ZGU7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRpZiAobXlkb2NfZGF0YS5sb25naXR1ZGUpIHtcclxuXHRcdFx0XHRcdHZhciBteWRvY19sb25nID0gbXlkb2NfZGF0YS5sb25naXR1ZGU7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRpZiAoIW15ZG9jX2RhdGEubGF0aXR1ZGUgfHwgIW15ZG9jX2RhdGEubG9uZ2l0dWRlKSB7XHJcblx0XHRcdFx0XHRtYXBwaW5nRXJyKCdtaXNzaW5nQ29vcnMnKTtcclxuXHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGxldCBteWRvY19sb2NfbWIgPSBbbXlkb2NfbG9uZywgbXlkb2NfbGF0XTtcclxuXHJcblx0XHRcdFx0bGV0IHNldHRpbmdzID0ge1xyXG5cdFx0XHRcdFx0Y2VudGVyOiBteWRvY19sb2NfbWIsXHJcblx0XHRcdFx0XHR6b29tOiAxNVxyXG5cdFx0XHRcdH07XHJcblxyXG5cdFx0XHRcdGxldCBteWRvY19tYXAgPSBteWRvYy5sb2FkTWFwKHNldHRpbmdzKTtcclxuXHJcblx0XHRcdFx0bXlkb2NfbWFwLm9uKCdsb2FkJywgZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdFx0JCgnI215ZG9jX21hcF9zdGF0dXMnKS5oaWRlKCk7XHJcblxyXG5cdFx0XHRcdFx0aWYgKCAkKCcjbXlkb2NfbWFwIC5hbGVydCcpLmlzKCc6dmlzaWJsZScpICkge1xyXG5cdFx0XHRcdFx0XHQkKCcjbXlkb2NfbWFwIC5hbGVydCcpLnJlbW92ZUF0dHIoJ3N0eWxlJyk7XHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0bGV0IG15ZG9jX21hcmtlciA9IG5ldyBtYXBib3hnbC5NYXJrZXIoKS5zZXRMbmdMYXQobXlkb2NfbG9jX21iKS5hZGRUbyhteWRvY19tYXApO1xyXG5cclxuXHRcdFx0XHRcdHZhciBtYXJrZXJIZWlnaHQgPSAzOCxcclxuXHRcdFx0XHRcdFx0bWFya2VyUmFkaXVzID0gOCxcclxuXHRcdFx0XHRcdFx0bGluZWFyT2Zmc2V0ID0gMTA7XHJcblxyXG5cdFx0XHRcdFx0dmFyIHBvcHVwT2Zmc2V0cyA9IHtcclxuXHRcdFx0XHRcdFx0J3RvcCc6IFswLCAwXSxcclxuXHRcdFx0XHRcdFx0J3RvcC1sZWZ0JzogWzAsMF0sXHJcblx0XHRcdFx0XHRcdCd0b3AtcmlnaHQnOiBbMCwwXSxcclxuXHRcdFx0XHRcdFx0J2JvdHRvbSc6IFswLCAtbWFya2VySGVpZ2h0XSxcclxuXHRcdFx0XHRcdFx0J2JvdHRvbS1sZWZ0JzogW2xpbmVhck9mZnNldCwgKG1hcmtlckhlaWdodCAtIG1hcmtlclJhZGl1cyArIGxpbmVhck9mZnNldCkgKiAtMV0sXHJcblx0XHRcdFx0XHRcdCdib3R0b20tcmlnaHQnOiBbLWxpbmVhck9mZnNldCwgKG1hcmtlckhlaWdodCAtIG1hcmtlclJhZGl1cyArIGxpbmVhck9mZnNldCkgKiAtMV0sXHJcblx0XHRcdFx0XHRcdCdsZWZ0JzogW21hcmtlclJhZGl1cywgKG1hcmtlckhlaWdodCAtIG1hcmtlclJhZGl1cykgKiAtMV0sXHJcblx0XHRcdFx0XHRcdCdyaWdodCc6IFstbWFya2VyUmFkaXVzLCAobWFya2VySGVpZ2h0IC0gbWFya2VyUmFkaXVzKSAqIC0xXVxyXG5cdFx0XHRcdFx0fTtcclxuXHJcblx0XHRcdFx0XHRsZXQgbXlkb2NfbG9jX3N0ciA9IG15ZG9jX2xhdCArICcsICcgKyBteWRvY19sb25nO1xyXG5cclxuXHRcdFx0XHRcdG15ZG9jX21hcF9wb3B1cF90ZW1wbGF0ZSA9ICc8c3BhbiBjbGFzcz1cIm15ZG9jX2lkXCI+JyArIG15ZG9jX2lkICsgJzwvc3Bhbj4nXHJcblx0XHRcdFx0XHRcdCsgJzxicj4nXHJcblx0XHRcdFx0XHRcdCsgbXlkb2NfbG9jX3N0clxyXG5cdFx0XHRcdFx0XHQvLyArICc8YnI+J1xyXG5cdFx0XHRcdFx0XHQvLyArICc8YSBocmVmPVwiI215ZG9jX2RldGFpbHNcIj5EZXRhaWxzPC9hPidcclxuXHRcdFx0XHRcdDtcclxuXHJcblx0XHRcdFx0XHRteWRvY19tYXBfcG9wdXAgPSBuZXcgbWFwYm94Z2wuUG9wdXAoe29mZnNldDogcG9wdXBPZmZzZXRzLCBjbGFzc05hbWU6ICdteWRvYy1tYXAtcG9wdXAnfSlcclxuXHRcdFx0XHRcdFx0LnNldExuZ0xhdChbbXlkb2NfbG9uZywgbXlkb2NfbGF0XSlcclxuXHRcdFx0XHRcdFx0LnNldEhUTUwobXlkb2NfbWFwX3BvcHVwX3RlbXBsYXRlKVxyXG5cdFx0XHRcdFx0XHQuYWRkVG8obXlkb2NfbWFwKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRtYXBwaW5nRXJyKCdpbnZhbGlkTXlkb2MnKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0ZnVuY3Rpb24gbWFwcGluZ0VyciAoY29uZGl0aW9uKSB7XHJcblx0XHRcdFx0dmFyIGVyck1zZztcclxuXHJcblx0XHRcdFx0c3dpdGNoIChjb25kaXRpb24pIHtcclxuXHRcdFx0XHRcdGNhc2UgJ2ludmFsaWRNeWRvYyc6XHJcblx0XHRcdFx0XHRcdCQoJyNteWRvY19kZXRhaWxzLCAjbXlkb2NfZGV0YWlscyA+IHNlY3Rpb24nKS5jc3MoJ3Zpc2liaWxpdHknLCAnaGlkZGVuJyk7XHJcblxyXG5cdFx0XHRcdFx0XHRlcnJNc2cgPSAnPHN0cm9uZz5Eb0MgaWQgbm90IGZvdW5kLjwvc3Ryb25nPiBQbGVhc2UgdHJ5IGFnYWluLic7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdGNhc2UgJ21pc3NpbmdDb29ycyc6XHJcblx0XHRcdFx0XHRcdGVyck1zZyA9ICc8c3Ryb25nPkNhblxcJ3QgbWFwIHRoaXMgRG9zZSBJRC48L3N0cm9uZz4gU2VlbXMgdG8gYmUgZnJvbSBsYWNrIG9mIGNvb3JkaW5hdGVzLiBTb3JyeSBhYm91dCB0aGF0Li4uID0vJztcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0ZGVmYXVsdDpcclxuXHRcdFx0XHRcdFx0ZXJyTXNnID0gJzxzdHJvbmc+Q2FuXFwndCBtYXAgdGhpcyBEb3NlIElELjwvc3Ryb25nPiBMb29rcyBsaWtlIHRoYXRcXCdzIGFsbCB0aGUgaW5mbyB0aGVyZSBpcy4gU29ycnkgYWJvdXQgdGhhdC4uLiA9Lyc7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0bGV0IG15ZG9jX21hcCA9IG15ZG9jLmxvYWRNYXAoKTtcclxuXHJcblx0XHRcdFx0bXlkb2NfbWFwLm9uKCdsb2FkJywgZnVuY3Rpb24gKCkge1xyXG5cclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKCdmaW5kTXlEb0MgbXlkb2NfbWFwLm9uKGxvYWQpIC0gaW52YWxpZCBpZCcpO1xyXG5cclxuXHRcdFx0XHRcdCQoJyNteWRvY19tYXBfc3RhdHVzJykuaGlkZSgpO1xyXG5cclxuXHRcdFx0XHRcdGlmICggJCgnI215ZG9jX21hcCAuYWxlcnQnKS5pcygnOnZpc2libGUnKSApIHtcclxuXHRcdFx0XHRcdFx0JCgnI215ZG9jX21hcCAuYWxlcnQnKS5yZW1vdmVBdHRyKCdzdHlsZScpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHQkKCcjbXlkb2NfbWFwJykuYXBwZW5kKCc8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtZGFuZ2VyIGFsZXJ0LWRpc21pc3NpYmxlIGZhZGUgc2hvd1wiIHJvbGU9XCJhbGVydFwiPicgKyBlcnJNc2cgKyAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJjbG9zZVwiIGRhdGEtZGlzbWlzcz1cImFsZXJ0XCIgYXJpYS1sYWJlbD1cIkNsb3NlXCI+PHNwYW4gYXJpYS1oaWRkZW49XCJ0cnVlXCI+JnRpbWVzOzwvc3Bhbj48L2J1dHRvbj48L2Rpdj4nKTtcclxuXHJcblx0XHRcdFx0Y29uc29sZS5sb2coICckKCNteWRvY19tYXBfc3RhdHVzKS5pcyg6dmlzaWJsZSk6ICcgKyAgJCgnI215ZG9jX21hcF9zdGF0dXMnKS5pcygnOnZpc2libGUnKSApO1xyXG5cclxuXHRcdFx0XHRpZiAoICQoJyNteWRvY19tYXBfc3RhdHVzJykuaXMoJzp2aXNpYmxlJykgKSB7XHJcblx0XHRcdFx0XHRsZXQgbWFwU3RhdHVzX2ggPSAkKCcjbXlkb2NfbWFwX3N0YXR1cycpLm91dGVySGVpZ2h0KCk7XHJcblxyXG5cdFx0XHRcdFx0JCgnI215ZG9jX21hcCAuYWxlcnQ6Zmlyc3QnKS5jc3MoJ21hcmdpbi10b3AnLCBtYXBTdGF0dXNfaCArIDE2ICsgJ3B4Jyk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQvKiogQXV0b2Nsb3NlIHRoZSBhbGVydHMgKi9cclxuXHRcdFx0XHQvKndpbmRvdy5zZXRUaW1lb3V0KCBmdW5jdGlvbiAoKSB7XHJcblx0XHQgICAgICAgICAgICAkKCcjbXlkb2NfbWFwIC5hbGVydCcpLmFsZXJ0KCdjbG9zZScpO1xyXG5cdFx0ICAgICAgICB9LCA0MDAwKTsqL1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn0pLmluaXQoKTtcclxuIl19
