var o="object"==typeof o?o:{};(o={init:function(){mapboxgl.accessToken="pk.eyJ1IjoidGhhdGJyYW0iLCJhIjoiY2p0YzM1NW9zMHM5MTN5cDRsdnJoOGw3byJ9.A7umZVt9Sx7Nb8jfN6M03g";let e=$.urlParam("mydocid");if(console.log("mydoc_id_queryStr_val: "+e),!1===e){o.loadMap().on("load",(function(){$("#mydoc_map_status").hide(),$("#mydoc_map .alert").is(":visible")&&$("#mydoc_map .alert").removeAttr("style")}))}else $("#mydoc_id_search_field").val(e),$("#mydoc_id_search_go").prop("disabled",!0),o.findMyDoC("url");$("#mydoc_id_search_field").on("input",(function(){let e=$(this).val();e=$.trim(e),e.length>4?($("#mydoc_id_search_go").prop("disabled",!1),$("#mydoc_id_search_field").off("keypress"),$("#mydoc_id_search_field").keypress((function(e){13===e.which&&o.findMyDoC("user")}))):($("#mydoc_id_search_go").prop("disabled",!0),$("#mydoc_id_search_field").off("keypress"))})),$("#mydoc_id_search_go").click((function(){o.findMyDoC("user")}))},loadMap:function(o){$("#mydoc_map_status").show();var e=[-105.547222,39],t=6.5;return void 0!==o&&(void 0!==o.center&&(e=o.center),void 0!==o.zoom&&(t=o.zoom)),new mapboxgl.Map({container:"mydoc_map",style:"mapbox://styles/thatbram/cjtokh26902ad1fm43xqm4kv2",center:e,zoom:t})},findMyDoC:function(e){let t;switch($("#mydoc_map .alert").alert("close"),e){case"user":console.log("source: user"),-1!==location.href.indexOf("?")&&history.pushState("",document.title,window.location.pathname),t=$("#mydoc_id_search_field").val(),t=$.trim(t);break;case"url":console.log("source: url");let o=$.urlParam("mydocid");t=o}t=t.toLowerCase(),$.ajax({url:"/.netlify/functions/mydoc_at?mydocid="+t,dataType:"json"}).done((function(e){if(console.log("resp: "),console.log(e),e.length>0){let r=t;var a=e[0].fields;if(console.log(a),history.pushState("",document.title,"?mydocid="+r),a.videos){var i=a.videos;i=i.split(","),$.each(i,(function(o,e){let t=e.substr(0,e.indexOf(":"));var a,i=e.substr(e.indexOf(":")+1,e.length);if("vimeo"===t)a='<iframe src="https://player.vimeo.com/video/'+i+'" class="video" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe>';$("#mydoc_details_videos_container").append(a)}))}else $("#mydoc_details_videos_container").html("");if(a.photos){var s=a.photos;s=s.split(","),$("#mydoc_details_photos_carousel").css("visibility","visible")}else $("#mydoc_details_photos_carousel").css("visibility","hidden");if(a.collection_date)a.collection_date;if(a.latitude)var l=a.latitude;if(a.longitude)var d=a.longitude;if(!a.latitude||!a.longitude)return void c("missingCoors");let n=[d,l],m={center:n,zoom:15},p=o.loadMap(m);p.on("load",(function(){$("#mydoc_map_status").hide(),$("#mydoc_map .alert").is(":visible")&&$("#mydoc_map .alert").removeAttr("style");(new mapboxgl.Marker).setLngLat(n).addTo(p);var o={top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38],"bottom-left":[10,-40],"bottom-right":[-10,-40],left:[8,-30],right:[-8,-30]};mydoc_map_popup_template='<span class="mydoc_id">'+r+"</span><br>"+(l+", "+d),mydoc_map_popup=new mapboxgl.Popup({offset:o,className:"mydoc-map-popup"}).setLngLat([d,l]).setHTML(mydoc_map_popup_template).addTo(p)}))}else c("invalidMydoc");function c(e){var t;switch(e){case"invalidMydoc":t="<strong>DoC id not found.</strong> Please try again.";break;case"missingCoors":t="<strong>Can't map this Dose ID.</strong> Seems to be from lack of coordinates. Sorry about that... =/";break;default:t="<strong>Can't map this Dose ID.</strong> Looks like that's all the info there is. Sorry about that... =/"}if(o.loadMap().on("load",(function(){console.log("findMyDoC mydoc_map.on(load) - invalid id"),$("#mydoc_map_status").hide(),$("#mydoc_map .alert").is(":visible")&&$("#mydoc_map .alert").removeAttr("style")})),$("#mydoc_map").append('<div class="alert alert-danger alert-dismissible fade show" role="alert">'+t+'<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'),console.log("$(#mydoc_map_status).is(:visible): "+$("#mydoc_map_status").is(":visible")),$("#mydoc_map_status").is(":visible")){let o=$("#mydoc_map_status").outerHeight();$("#mydoc_map .alert:first").css("margin-top",o+16+"px")}}}))}}).init();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXkubWluLmpzIiwibmFtZXMiOlsibXlkb2MiLCJpbml0IiwibWFwYm94Z2wiLCJhY2Nlc3NUb2tlbiIsIm15ZG9jX2lkX3F1ZXJ5U3RyX3ZhbCIsIiQiLCJ1cmxQYXJhbSIsImNvbnNvbGUiLCJsb2ciLCJsb2FkTWFwIiwib24iLCJoaWRlIiwiaXMiLCJyZW1vdmVBdHRyIiwidmFsIiwicHJvcCIsImZpbmRNeURvQyIsIm15ZG9jX2lkX3NlYXJjaF92YWwiLCJ0aGlzIiwidHJpbSIsImxlbmd0aCIsIm9mZiIsImtleXByZXNzIiwiZSIsIndoaWNoIiwiY2xpY2siLCJzZXR0aW5ncyIsInNob3ciLCJjZW50ZXIiLCJ6b29tIiwiTWFwIiwiY29udGFpbmVyIiwic3R5bGUiLCJzb3VyY2UiLCJhbGVydCIsImxvY2F0aW9uIiwiaHJlZiIsImluZGV4T2YiLCJoaXN0b3J5IiwicHVzaFN0YXRlIiwiZG9jdW1lbnQiLCJ0aXRsZSIsIndpbmRvdyIsInBhdGhuYW1lIiwidG9Mb3dlckNhc2UiLCJhamF4IiwidXJsIiwiZGF0YVR5cGUiLCJkb25lIiwicmVzcCIsIm15ZG9jX2lkIiwibXlkb2NfZGF0YSIsImZpZWxkcyIsInZpZGVvcyIsInZpZGVvc0FyciIsInNwbGl0IiwiZWFjaCIsImlkeCIsIml0bSIsInZpZFN2YyIsInN1YnN0ciIsInZpZE9iaiIsInZpZElkIiwiYXBwZW5kIiwiaHRtbCIsInBob3RvcyIsInBob3Rvc0FyciIsImNzcyIsImNvbGxlY3Rpb25fZGF0ZSIsImxhdGl0dWRlIiwibXlkb2NfbGF0IiwibG9uZ2l0dWRlIiwibXlkb2NfbG9uZyIsIm1hcHBpbmdFcnIiLCJteWRvY19sb2NfbWIiLCJteWRvY19tYXAiLCJNYXJrZXIiLCJzZXRMbmdMYXQiLCJhZGRUbyIsInBvcHVwT2Zmc2V0cyIsInRvcCIsImJvdHRvbSIsImxlZnQiLCJyaWdodCIsIm15ZG9jX21hcF9wb3B1cF90ZW1wbGF0ZSIsIm15ZG9jX21hcF9wb3B1cCIsIlBvcHVwIiwib2Zmc2V0IiwiY2xhc3NOYW1lIiwic2V0SFRNTCIsImNvbmRpdGlvbiIsImVyck1zZyIsIm1hcFN0YXR1c19oIiwib3V0ZXJIZWlnaHQiXSwic291cmNlcyI6WyJteS5qcyJdLCJtYXBwaW5ncyI6IkFBQ0EsSUFBSUEsRUFBNkIsaUJBQVosRUFBeUJBLEVBQVEsQ0FBQyxHQUN0REEsRUFBUSxDQUNSQyxLQUFPLFdBQ05DLFNBQVNDLFlBQWMsNkZBQ3ZCLElBQUlDLEVBQXdCQyxFQUFFQyxTQUFTLFdBSXZDLEdBRkFDLFFBQVFDLElBQUksMEJBQTRCSixJQUVULElBQTFCQSxFQUFrQyxDQUN0QkosRUFBTVMsVUFFWkMsR0FBRyxRQUFRLFdBQ3BCTCxFQUFFLHFCQUFxQk0sT0FFbEJOLEVBQUUscUJBQXFCTyxHQUFHLGFBQzlCUCxFQUFFLHFCQUFxQlEsV0FBVyxRQUVwQyxHQUNELE1BQ0NSLEVBQUUsMEJBQTBCUyxJQUFJVixHQUVoQ0MsRUFBRSx1QkFBdUJVLEtBQUssWUFBWSxHQUUxQ2YsRUFBTWdCLFVBQVUsT0FHakJYLEVBQUUsMEJBQTBCSyxHQUFHLFNBQVMsV0FDdkMsSUFBSU8sRUFBc0JaLEVBQUVhLE1BQU1KLE1BQ2pDRyxFQUFzQlosRUFBRWMsS0FBS0YsR0FFMUJBLEVBQW9CRyxPQUFTLEdBQ2hDZixFQUFFLHVCQUF1QlUsS0FBSyxZQUFZLEdBQzFDVixFQUFFLDBCQUEwQmdCLElBQUksWUFDaENoQixFQUFFLDBCQUEwQmlCLFVBQVUsU0FBVUMsR0FDL0IsS0FBWkEsRUFBRUMsT0FDTHhCLEVBQU1nQixVQUFVLE9BRWxCLE1BRUFYLEVBQUUsdUJBQXVCVSxLQUFLLFlBQVksR0FDMUNWLEVBQUUsMEJBQTBCZ0IsSUFBSSxZQUVsQyxJQUVBaEIsRUFBRSx1QkFBdUJvQixPQUFPLFdBQy9CekIsRUFBTWdCLFVBQVUsT0FDakIsR0FDRCxFQUVBUCxRQUFVLFNBQVVpQixHQUNuQnJCLEVBQUUscUJBQXFCc0IsT0FFdkIsSUFBSUMsRUFBUyxFQUFFLFdBQVksSUFDdkJDLEVBQU8sSUFxQlgsWUFuQndCLElB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SzFCQyx5QkFBMkIsMEJBQTRCbEMsRUFBNUIsZUFGUG9CLEVBQVksS0FBT0UsR0FTdkNhLGdCQUFrQixJQUFJbkYsU0FBU29GLE1BQU0sQ0FBQ0MsT0FBUVIsRUFBY1MsVUFBVyxvQkFDckVYLFVBQVUsQ0FBQ0wsRUFBWUYsSUFDdkJtQixRQUFRTCwwQkFDUk4sTUFBTUgsRUFDVCxHQUNELE1BQ0NGLEVBQVcsZ0JBR1osU0FBU0EsRUFBWWlCLEdBQ3BCLElBQUlDLEVBRUosT0FBUUQsR0FDUCxJQUFLLGVBQ0pDLEVBQVMsdURBQ1YsTUFDQSxJQUFLLGVBQ0pBLEVBQVMsd0dBQ1YsTUFDQSxRQUNDQSxFQUFTLDJHQW9CWCxHQWpCZ0IzRixFQUFNUyxVQUVaQyxHQUFHLFFBQVEsV0FFcEJILFFBQVFDLElBQUksNkNBRVpILEVBQUUscUJBQXFCTSxPQUVsQk4sRUFBRSxxQkFBcUJPLEdBQUcsYUFDOUJQLEVBQUUscUJBQXFCUSxXQUFXLFFBRXBDLElBRUFSLEVBQUUsY0FBYzBELE9BQU8sNEVBQThFNEIsRUFBUyxzSUFFOUdwRixRQUFRQyxJQUFLLHNDQUF5Q0gsRUFBRSxxQkFBcUJPLEdBQUcsYUFFM0VQLEVBQUUscUJBQXFCTyxHQUFHLFlBQWMsQ0FDNUMsSUFBSWdGLEVBQWN2RixFQUFFLHFCQUFxQndGLGNBRXpDeEYsRUFBRSwyQkFBMkI4RCxJQUFJLGFBQWN5QixFQUFjLEdBQUssS0FDbkUsQ0FNRCxDQUNELEdBQ0QsSUFDRTNGIiwic291cmNlc0NvbnRlbnQiOlsiLyoqIG15LmpzICovXG52YXIgbXlkb2MgPSAoIHR5cGVvZiAobXlkb2MpID09PSAnb2JqZWN0JyApID8gbXlkb2MgOiB7fTtcbihteWRvYyA9IHtcblx0aW5pdCA6IGZ1bmN0aW9uICgpIHtcblx0XHRtYXBib3hnbC5hY2Nlc3NUb2tlbiA9ICdway5leUoxSWpvaWRHaGhkR0p5WVcwaUxDSmhJam9pWTJwMFl6TTFOVzl6TUhNNU1UTjVjRFJzZG5Kb09HdzNieUo5LkE3dW1aVnQ5U3g3TmI4amZONk0wM2cnO1xuXHRcdGxldCBteWRvY19pZF9xdWVyeVN0cl92YWwgPSAkLnVybFBhcmFtKCdteWRvY2lkJyk7XG5cblx0XHRjb25zb2xlLmxvZygnbXlkb2NfaWRfcXVlcnlTdHJfdmFsOiAnICsgbXlkb2NfaWRfcXVlcnlTdHJfdmFsKTtcblxuXHRcdGlmICggbXlkb2NfaWRfcXVlcnlTdHJfdmFsID09PSBmYWxzZSApIHtcblx0XHRcdGxldCBteWRvY19tYXAgPSBteWRvYy5sb2FkTWFwKCk7XG5cblx0XHRcdG15ZG9jX21hcC5vbignbG9hZCcsIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0JCgnI215ZG9jX21hcF9zdGF0dXMnKS5oaWRlKCk7XG5cblx0XHRcdFx0aWYgKCAkKCcjbXlkb2NfbWFwIC5hbGVydCcpLmlzKCc6dmlzaWJsZScpICkge1xuXHRcdFx0XHRcdCQoJyNteWRvY19tYXAgLmFsZXJ0JykucmVtb3ZlQXR0cignc3R5bGUnKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdCQoJyNteWRvY19pZF9zZWFyY2hfZmllbGQnKS52YWwobXlkb2NfaWRfcXVlcnlTdHJfdmFsKTtcblxuXHRcdFx0JCgnI215ZG9jX2lkX3NlYXJjaF9nbycpLnByb3AoJ2Rpc2FibGVkJywgdHJ1ZSk7XG5cblx0XHRcdG15ZG9jLmZpbmRNeURvQygndXJsJyk7XG5cdFx0fVxuXG5cdFx0JCgnI215ZG9jX2lkX3NlYXJjaF9maWVsZCcpLm9uKCdpbnB1dCcsIGZ1bmN0aW9uICgpIHtcblx0XHRcdGxldCBteWRvY19pZF9zZWFyY2hfdmFsID0gJCh0aGlzKS52YWwoKTtcblx0XHRcdFx0bXlkb2NfaWRfc2VhcmNoX3ZhbCA9ICQudHJpbShteWRvY19pZF9zZWFyY2hfdmFsKTtcblxuXHRcdFx0aWYgKG15ZG9jX2lkX3NlYXJjaF92YWwubGVuZ3RoID4gNCkge1xuXHRcdFx0XHQkKCcjbXlkb2NfaWRfc2VhcmNoX2dvJykucHJvcCgnZGlzYWJsZWQnLCBmYWxzZSk7XG5cdFx0XHRcdCQoJyNteWRvY19pZF9zZWFyY2hfZmllbGQnKS5vZmYoJ2tleXByZXNzJyk7XG5cdFx0XHRcdCQoJyNteWRvY19pZF9zZWFyY2hfZmllbGQnKS5rZXlwcmVzcyggZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0XHRpZiAoZS53aGljaCA9PT0gMTMpIHtcblx0XHRcdFx0XHRcdG15ZG9jLmZpbmRNeURvQygndXNlcicpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQkKCcjbXlkb2NfaWRfc2VhcmNoX2dvJykucHJvcCgnZGlzYWJsZWQnLCB0cnVlKTtcblx0XHRcdFx0JCgnI215ZG9jX2lkX3NlYXJjaF9maWVsZCcpLm9mZigna2V5cHJlc3MnKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdCQoJyNteWRvY19pZF9zZWFyY2hfZ28nKS5jbGljayggZnVuY3Rpb24gKCkge1xuXHRcdFx0bXlkb2MuZmluZE15RG9DKCd1c2VyJyk7XG5cdFx0fSk7XG5cdH1cblx0LFxuXHRsb2FkTWFwIDogZnVuY3Rpb24gKHNldHRpbmdzKSB7XG5cdFx0JCgnI215ZG9jX21hcF9zdGF0dXMnKS5zaG93KCk7XG5cblx0XHR2YXIgY2VudGVyID0gWy0xMDUuNTQ3MjIyLCAzOV07XG5cdFx0dmFyIHpvb20gPSA2LjU7XG5cblx0XHRpZiAodHlwZW9mIHNldHRpbmdzICE9PSAndW5kZWZpbmVkJykge1xuXHRcdFx0LyoqIElmIG5vIG1hcCBjZW50ZXIgaXMgc3BlY2lmaWVkLCBzZXQgdG8gZ2VvZ3JhcGhpYyBjZW50ZXIgb2YgQ29sb3JhZG8gKi9cblx0XHRcdGlmICh0eXBlb2Ygc2V0dGluZ3MuY2VudGVyICE9PSAndW5kZWZpbmVkJykge1xuXHRcdFx0XHRjZW50ZXIgPSBzZXR0aW5ncy5jZW50ZXI7XG5cdFx0XHR9XG5cblx0XHRcdC8qKiBJZiBubyBtYXAgem9vbSBsZXZlbCBpcyBzcGVjaWZpZWQsIHNldCB0byBhIGxldmVsIG1ha2luZyBDb2xvcmFkbyBpZGVudGlmaWFibGUgYWNyb3NzIHdpZGVzdCB2YXJpZXR5IG9mIHJlc29sdXRpb25zICovXG5cdFx0XHRpZiAodHlwZW9mIHNldHRpbmdzLnpvb20gIT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRcdHpvb20gPSBzZXR0aW5ncy56b29tO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGxldCBteWRvY19tYXAgPSBuZXcgbWFwYm94Z2wuTWFwKHtcblx0XHRcdGNvbnRhaW5lcjogJ215ZG9jX21hcCcsXG5cdFx0XHRzdHlsZTogJ21hcGJveDovL3N0eWxlcy90aGF0YnJhbS9janRva2gyNjkwMmFkMWZtNDN4cW00a3YyJywgLy8gJ1JhZG8gMlxuXHRcdFx0Y2VudGVyOiBjZW50ZXIsXG5cdFx0XHR6b29tOiB6b29tXG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gbXlkb2NfbWFwO1xuXHR9XG5cdCxcblx0ZmluZE15RG9DIDogZnVuY3Rpb24gKHNvdXJjZSkge1xuXHRcdCQoJyNteWRvY19tYXAgLmFsZXJ0JykuYWxlcnQoJ2Nsb3NlJyk7XG5cblx0XHRsZXQgbXlkb2NfaWRfc2VhcmNoX3ZhbDtcblxuXHRcdHN3aXRjaCAoc291cmNlKSB7XG5cdFx0XHRjYXNlICd1c2VyJzpcblxuXHRcdFx0XHRjb25zb2xlLmxvZygnc291cmNlOiB1c2VyJyk7XG5cblx0XHRcdFx0dmFyIHFTdHJfaWR4ID0gbG9jYXRpb24uaHJlZi5pbmRleE9mKCc/Jyk7XG5cblx0XHRcdFx0aWYgKHFTdHJfaWR4ICE9PSAtMSkge1xuXHRcdFx0XHRcdGhpc3RvcnkucHVzaFN0YXRlKCcnLCBkb2N1bWVudC50aXRsZSwgd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdG15ZG9jX2lkX3NlYXJjaF92YWwgPSAkKCcjbXlkb2NfaWRfc2VhcmNoX2ZpZWxkJykudmFsKCk7XG5cdFx0XHRcdG15ZG9jX2lkX3NlYXJjaF92YWwgPSAkLnRyaW0obXlkb2NfaWRfc2VhcmNoX3ZhbCk7XG5cdFx0XHRicmVhaztcblx0XHRcdGNhc2UgJ3VybCc6XG5cblx0XHRcdFx0Y29uc29sZS5sb2coJ3NvdXJjZTogdXJsJyk7XG5cblx0XHRcdFx0bGV0IG15ZG9jX2lkX3F1ZXJ5U3RyX3ZhbCA9ICQudXJsUGFyYW0oJ215ZG9jaWQnKTtcblx0XHRcdFx0bXlkb2NfaWRfc2VhcmNoX3ZhbCA9IG15ZG9jX2lkX3F1ZXJ5U3RyX3ZhbDtcblx0XHR9XG5cblx0XHRteWRvY19pZF9zZWFyY2hfdmFsID0gbXlkb2NfaWRfc2VhcmNoX3ZhbC50b0xvd2VyQ2FzZSgpO1xuXG5cdFx0JC5hamF4KHtcblx0XHRcdHVybDogJy8ubmV0bGlmeS9mdW5jdGlvbnMvbXlkb2NfYXQ/bXlkb2NpZD0nICsgbXlkb2NfaWRfc2VhcmNoX3ZhbCxcblx0XHRcdGRhdGFUeXBlOiAnanNvbidcblx0XHR9KS5kb25lKCBmdW5jdGlvbiAocmVzcCkge1xuXG5cdFx0XHRjb25zb2xlLmxvZygncmVzcDogJyk7XG5cdFx0XHRjb25zb2xlLmxvZyhyZXNwKTtcblxuXHRcdFx0aWYgKHJlc3AubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRsZXQgbXlkb2NfaWQgPSBteWRvY19pZF9zZWFyY2hfdmFsO1xuXHRcdFx0XHR2YXIgbXlkb2NfZGF0YSA9IHJlc3BbMF0uZmllbGRzO1xuXG5cdFx0XHRcdGNvbnNvbGUubG9nKG15ZG9jX2RhdGEpO1xuXG5cdFx0XHRcdC8qKiBTZXQgZGlyZWN0bHkgYWNjZXNzaWJsZSBVUkwgKi9cblx0XHRcdFx0aGlzdG9yeS5wdXNoU3RhdGUoJycsIGRvY3VtZW50LnRpdGxlLCAnP215ZG9jaWQ9JyArIG15ZG9jX2lkKTtcblxuXHRcdFx0XHRpZiAobXlkb2NfZGF0YS52aWRlb3MpIHtcblx0XHRcdFx0XHR2YXIgdmlkZW9zQXJyID0gbXlkb2NfZGF0YS52aWRlb3M7XG5cdFx0XHRcdFx0XHR2aWRlb3NBcnIgPSB2aWRlb3NBcnIuc3BsaXQoJywnKTtcblxuXHRcdFx0XHRcdCQuZWFjaCh2aWRlb3NBcnIsIGZ1bmN0aW9uIChpZHgsIGl0bSkge1xuXHRcdFx0XHRcdFx0bGV0IHZpZFN2YyA9IGl0bS5zdWJzdHIoMCwgaXRtLmluZGV4T2YoJzonKSk7XG5cdFx0XHRcdFx0XHR2YXIgdmlkSWQgPSBpdG0uc3Vic3RyKGl0bS5pbmRleE9mKCc6JykrMSwgaXRtLmxlbmd0aCk7XG5cdFx0XHRcdFx0XHR2YXIgdmlkT2JqO1xuXG5cdFx0XHRcdFx0XHRzd2l0Y2ggKHZpZFN2Yykge1xuXHRcdFx0XHRcdFx0XHRjYXNlICd2aW1lbyc6XG5cdFx0XHRcdFx0XHRcdFx0dmlkT2JqID0gJzxpZnJhbWUgc3JjPVwiaHR0cHM6Ly9wbGF5ZXIudmltZW8uY29tL3ZpZGVvLycgKyB2aWRJZCArICdcIiBjbGFzcz1cInZpZGVvXCIgZnJhbWVib3JkZXI9XCIwXCIgYWxsb3c9XCJhdXRvcGxheTsgZnVsbHNjcmVlblwiIGFsbG93ZnVsbHNjcmVlbj48L2lmcmFtZT4nO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0Ly8gY2FzZSAneW91dHViZSc6XG5cdFx0XHRcdFx0XHRcdFx0Ly8gdmlkT2JqID0gJyc7IC8vICdodHRwczovL3lvdXR1YmUuY29tL3dhdGNoP3Y9JyArIHZpZElkO1xuXHRcdFx0XHRcdFx0XHQvLyBicmVhaztcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0JCgnI215ZG9jX2RldGFpbHNfdmlkZW9zX2NvbnRhaW5lcicpLmFwcGVuZCh2aWRPYmopO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdCQoJyNteWRvY19kZXRhaWxzX3ZpZGVvc19jb250YWluZXInKS5odG1sKCcnKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKiBcblx0XHRcdFx0ICogRm9yIGltYWdlIGRpc3BsYXkvY2Fyb3VzZWwsIHVzZSBuYW1pbmcgY29udmVudGlvbiwgZm9yIGV4YW1wbGU6XG5cdFx0XHRcdCAqIC0gYWxwaGEwMS5qcGcsIGFscGhhMDIuanBnXG5cdFx0XHRcdCAqIG9yXG5cdFx0XHRcdCAqIC0gL2FscGhhLzAxLmpwZywgL2FscGhhLzAyLmpwZ1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRpZiAobXlkb2NfZGF0YS5waG90b3MpIHtcblx0XHRcdFx0XHR2YXIgcGhvdG9zQXJyID0gbXlkb2NfZGF0YS5waG90b3M7XG5cdFx0XHRcdFx0XHRwaG90b3NBcnIgPSBwaG90b3NBcnIuc3BsaXQoJywnKTtcblxuXHRcdFx0XHRcdFx0JCgnI215ZG9jX2RldGFpbHNfcGhvdG9zX2Nhcm91c2VsJykuY3NzKCd2aXNpYmlsaXR5JywgJ3Zpc2libGUnKTtcblxuXHRcdFx0XHRcdC8qJC5lYWNoKHBob3Rvc0FyciwgZnVuY3Rpb24gKGlkeCwgaXRtKSB7XG5cdFx0XHRcdFx0XHQvL1xuXHRcdFx0XHRcdH0pOyovXG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0JCgnI215ZG9jX2RldGFpbHNfcGhvdG9zX2Nhcm91c2VsJykuY3NzKCd2aXNpYmlsaXR5JywgJ2hpZGRlbicpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKG15ZG9jX2RhdGEuY29sbGVjdGlvbl9kYXRlKSB7XG5cdFx0XHRcdFx0dmFyIG15ZG9jX2NvbGxEYXRlID0gbXlkb2NfZGF0YS5jb2xsZWN0aW9uX2RhdGU7XG5cblx0XHRcdFx0XHQvLyBEbyB0aGUgZGF0ZSBzdHVmZlxuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKG15ZG9jX2RhdGEubGF0aXR1ZGUpIHtcblx0XHRcdFx0XHR2YXIgbXlkb2NfbGF0ID0gbXlkb2NfZGF0YS5sYXRpdHVkZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChteWRvY19kYXRhLmxvbmdpdHVkZSkge1xuXHRcdFx0XHRcdHZhciBteWRvY19sb25nID0gbXlkb2NfZGF0YS5sb25naXR1ZGU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoIW15ZG9jX2RhdGEubGF0aXR1ZGUgfHwgIW15ZG9jX2RhdGEubG9uZ2l0dWRlKSB7XG5cdFx0XHRcdFx0bWFwcGluZ0VycignbWlzc2luZ0Nvb3JzJyk7XG5cblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGxldCBteWRvY19sb2NfbWIgPSBbbXlkb2NfbG9uZywgbXlkb2NfbGF0XTtcblxuXHRcdFx0XHRsZXQgc2V0dGluZ3MgPSB7XG5cdFx0XHRcdFx0Y2VudGVyOiBteWRvY19sb2NfbWIsXG5cdFx0XHRcdFx0em9vbTogMTVcblx0XHRcdFx0fTtcblxuXHRcdFx0XHRsZXQgbXlkb2NfbWFwID0gbXlkb2MubG9hZE1hcChzZXR0aW5ncyk7XG5cblx0XHRcdFx0bXlkb2NfbWFwLm9uKCdsb2FkJywgZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdCQoJyNteWRvY19tYXBfc3RhdHVzJykuaGlkZSgpO1xuXG5cdFx0XHRcdFx0aWYgKCAkKCcjbXlkb2NfbWFwIC5hbGVydCcpLmlzKCc6dmlzaWJsZScpICkge1xuXHRcdFx0XHRcdFx0JCgnI215ZG9jX21hcCAuYWxlcnQnKS5yZW1vdmVBdHRyKCdzdHlsZScpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGxldCBteWRvY19tYXJrZXIgPSBuZXcgbWFwYm94Z2wuTWFya2VyKCkuc2V0TG5nTGF0KG15ZG9jX2xvY19tYikuYWRkVG8obXlkb2NfbWFwKTtcblxuXHRcdFx0XHRcdHZhciBtYXJrZXJIZWlnaHQgPSAzOCxcblx0XHRcdFx0XHRcdG1hcmtlclJhZGl1cyA9IDgsXG5cdFx0XHRcdFx0XHRsaW5lYXJPZmZzZXQgPSAxMDtcblxuXHRcdFx0XHRcdHZhciBwb3B1cE9mZnNldHMgPSB7XG5cdFx0XHRcdFx0XHQndG9wJzogWzAsIDBdLFxuXHRcdFx0XHRcdFx0J3RvcC1sZWZ0JzogWzAsMF0sXG5cdFx0XHRcdFx0XHQndG9wLXJpZ2h0JzogWzAsMF0sXG5cdFx0XHRcdFx0XHQnYm90dG9tJzogWzAsIC1tYXJrZXJIZWlnaHRdLFxuXHRcdFx0XHRcdFx0J2JvdHRvbS1sZWZ0JzogW2xpbmVhck9mZnNldCwgKG1hcmtlckhlaWdodCAtIG1hcmtlclJhZGl1cyArIGxpbmVhck9mZnNldCkgKiAtMV0sXG5cdFx0XHRcdFx0XHQnYm90dG9tLXJpZ2h0JzogWy1saW5lYXJPZmZzZXQsIChtYXJrZXJIZWlnaHQgLSBtYXJrZXJSYWRpdXMgKyBsaW5lYXJPZmZzZXQpICogLTFdLFxuXHRcdFx0XHRcdFx0J2xlZnQnOiBbbWFya2VyUmFkaXVzLCAobWFya2VySGVpZ2h0IC0gbWFya2VyUmFkaXVzKSAqIC0xXSxcblx0XHRcdFx0XHRcdCdyaWdodCc6IFstbWFya2VyUmFkaXVzLCAobWFya2VySGVpZ2h0IC0gbWFya2VyUmFkaXVzKSAqIC0xXVxuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRsZXQgbXlkb2NfbG9jX3N0ciA9IG15ZG9jX2xhdCArICcsICcgKyBteWRvY19sb25nO1xuXG5cdFx0XHRcdFx0bXlkb2NfbWFwX3BvcHVwX3RlbXBsYXRlID0gJzxzcGFuIGNsYXNzPVwibXlkb2NfaWRcIj4nICsgbXlkb2NfaWQgKyAnPC9zcGFuPidcblx0XHRcdFx0XHRcdCsgJzxicj4nXG5cdFx0XHRcdFx0XHQrIG15ZG9jX2xvY19zdHJcblx0XHRcdFx0XHRcdC8vICsgJzxicj4nXG5cdFx0XHRcdFx0XHQvLyArICc8YSBocmVmPVwiI215ZG9jX2RldGFpbHNcIj5EZXRhaWxzPC9hPidcblx0XHRcdFx0XHQ7XG5cblx0XHRcdFx0XHRteWRvY19tYXBfcG9wdXAgPSBuZXcgbWFwYm94Z2wuUG9wdXAoe29mZnNldDogcG9wdXBPZmZzZXRzLCBjbGFzc05hbWU6ICdteWRvYy1tYXAtcG9wdXAnfSlcblx0XHRcdFx0XHRcdC5zZXRMbmdMYXQoW215ZG9jX2xvbmcsIG15ZG9jX2xhdF0pXG5cdFx0XHRcdFx0XHQuc2V0SFRNTChteWRvY19tYXBfcG9wdXBfdGVtcGxhdGUpXG5cdFx0XHRcdFx0XHQuYWRkVG8obXlkb2NfbWFwKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRtYXBwaW5nRXJyKCdpbnZhbGlkTXlkb2MnKTtcblx0XHRcdH1cblxuXHRcdFx0ZnVuY3Rpb24gbWFwcGluZ0VyciAoY29uZGl0aW9uKSB7XG5cdFx0XHRcdHZhciBlcnJNc2c7XG5cblx0XHRcdFx0c3dpdGNoIChjb25kaXRpb24pIHtcblx0XHRcdFx0XHRjYXNlICdpbnZhbGlkTXlkb2MnOlxuXHRcdFx0XHRcdFx0ZXJyTXNnID0gJzxzdHJvbmc+RG9DIGlkIG5vdCBmb3VuZC48L3N0cm9uZz4gUGxlYXNlIHRyeSBhZ2Fpbi4nO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgJ21pc3NpbmdDb29ycyc6XG5cdFx0XHRcdFx0XHRlcnJNc2cgPSAnPHN0cm9uZz5DYW5cXCd0IG1hcCB0aGlzIERvc2UgSUQuPC9zdHJvbmc+IFNlZW1zIHRvIGJlIGZyb20gbGFjayBvZiBjb29yZGluYXRlcy4gU29ycnkgYWJvdXQgdGhhdC4uLiA9Lyc7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRcdGVyck1zZyA9ICc8c3Ryb25nPkNhblxcJ3QgbWFwIHRoaXMgRG9zZSBJRC48L3N0cm9uZz4gTG9va3MgbGlrZSB0aGF0XFwncyBhbGwgdGhlIGluZm8gdGhlcmUgaXMuIFNvcnJ5IGFib3V0IHRoYXQuLi4gPS8nO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGxldCBteWRvY19tYXAgPSBteWRvYy5sb2FkTWFwKCk7XG5cblx0XHRcdFx0bXlkb2NfbWFwLm9uKCdsb2FkJywgZnVuY3Rpb24gKCkge1xuXG5cdFx0XHRcdFx0Y29uc29sZS5sb2coJ2ZpbmRNeURvQyBteWRvY19tYXAub24obG9hZCkgLSBpbnZhbGlkIGlkJyk7XG5cblx0XHRcdFx0XHQkKCcjbXlkb2NfbWFwX3N0YXR1cycpLmhpZGUoKTtcblxuXHRcdFx0XHRcdGlmICggJCgnI215ZG9jX21hcCAuYWxlcnQnKS5pcygnOnZpc2libGUnKSApIHtcblx0XHRcdFx0XHRcdCQoJyNteWRvY19tYXAgLmFsZXJ0JykucmVtb3ZlQXR0cignc3R5bGUnKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdCQoJyNteWRvY19tYXAnKS5hcHBlbmQoJzxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC1kYW5nZXIgYWxlcnQtZGlzbWlzc2libGUgZmFkZSBzaG93XCIgcm9sZT1cImFsZXJ0XCI+JyArIGVyck1zZyArICc8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImNsb3NlXCIgZGF0YS1kaXNtaXNzPVwiYWxlcnRcIiBhcmlhLWxhYmVsPVwiQ2xvc2VcIj48c3BhbiBhcmlhLWhpZGRlbj1cInRydWVcIj4mdGltZXM7PC9zcGFuPjwvYnV0dG9uPjwvZGl2PicpO1xuXG5cdFx0XHRcdGNvbnNvbGUubG9nKCAnJCgjbXlkb2NfbWFwX3N0YXR1cykuaXMoOnZpc2libGUpOiAnICsgICQoJyNteWRvY19tYXBfc3RhdHVzJykuaXMoJzp2aXNpYmxlJykgKTtcblxuXHRcdFx0XHRpZiAoICQoJyNteWRvY19tYXBfc3RhdHVzJykuaXMoJzp2aXNpYmxlJykgKSB7XG5cdFx0XHRcdFx0bGV0IG1hcFN0YXR1c19oID0gJCgnI215ZG9jX21hcF9zdGF0dXMnKS5vdXRlckhlaWdodCgpO1xuXG5cdFx0XHRcdFx0JCgnI215ZG9jX21hcCAuYWxlcnQ6Zmlyc3QnKS5jc3MoJ21hcmdpbi10b3AnLCBtYXBTdGF0dXNfaCArIDE2ICsgJ3B4Jyk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKiogQXV0b2Nsb3NlIHRoZSBhbGVydHMgKi9cblx0XHRcdFx0Lyp3aW5kb3cuc2V0VGltZW91dCggZnVuY3Rpb24gKCkge1xuXHRcdCAgICAgICAgICAgICQoJyNteWRvY19tYXAgLmFsZXJ0JykuYWxlcnQoJ2Nsb3NlJyk7XG5cdFx0ICAgICAgICB9LCA0MDAwKTsqL1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG59KS5pbml0KCk7XG4iXX0=
