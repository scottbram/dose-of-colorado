var o="object"==typeof o?o:{};(o={init:function(){mapboxgl.accessToken="pk.eyJ1IjoidGhhdGJyYW0iLCJhIjoiY2p0YzM1NW9zMHM5MTN5cDRsdnJoOGw3byJ9.A7umZVt9Sx7Nb8jfN6M03g";let e=$.urlParam("mydocid");if(console.log("mydoc_id_queryStr_val: "+e),!1===e){o.loadMap().on("load",function(){$("#mydoc_map_status").hide(),$("#mydoc_map .alert").is(":visible")&&$("#mydoc_map .alert").removeAttr("style")})}else $("#mydoc_id_search_field").val(e),$("#mydoc_id_search_go").prop("disabled",!0),o.findMyDoC("url");$("#mydoc_id_search_field").on("input",function(){let e=$(this).val();(e=$.trim(e)).length>4?($("#mydoc_id_search_go").prop("disabled",!1),$("#mydoc_id_search_field").off("keypress"),$("#mydoc_id_search_field").keypress(function(e){13===e.which&&o.findMyDoC("user")})):($("#mydoc_id_search_go").prop("disabled",!0),$("#mydoc_id_search_field").off("keypress"))}),$("#mydoc_id_search_go").click(function(){o.findMyDoC("user")})},loadMap:function(o){$("#mydoc_map_status").show();var e=[-105.547222,39],t=6.5;return void 0!==o&&(void 0!==o.center&&(e=o.center),void 0!==o.zoom&&(t=o.zoom)),new mapboxgl.Map({container:"mydoc_map",style:"mapbox://styles/thatbram/cjtokh26902ad1fm43xqm4kv2",center:e,zoom:t})},findMyDoC:function(e){let t;switch($("#mydoc_map .alert").alert("close"),e){case"user":console.log("source: user"),-1!==location.href.indexOf("?")&&history.pushState("",document.title,window.location.pathname),t=$("#mydoc_id_search_field").val(),t=$.trim(t);break;case"url":console.log("source: url");let o=$.urlParam("mydocid");t=o}t=t.toLowerCase(),$.ajax({url:"/.netlify/functions/mydoc_at?mydocid="+t,dataType:"json"}).done(function(e){if(console.log("resp: "),console.log(e),e.length>0){let c=t;var a=e[0].fields;if(console.log(a),history.pushState("",document.title,"?mydocid="+c),a.videos){var i=a.videos;i=i.split(","),$.each(i,function(o,e){let t=e.substr(0,e.indexOf(":"));var a,i=e.substr(e.indexOf(":")+1,e.length);switch(t){case"vimeo":a='<iframe src="https://player.vimeo.com/video/'+i+'" class="video" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe>'}$("#mydoc_details_videos_container").append(a)})}else $("#mydoc_details_videos_container").html("");if(a.photos){var s=a.photos;s=s.split(",")}if(a.collection_date)a.collection_date;if(a.latitude)var d=a.latitude;if(a.longitude)var l=a.longitude;if(!a.latitude||!a.longitude)return void r("missingCoors");let n=[l,d],m={center:n,zoom:15},p=o.loadMap(m);p.on("load",function(){$("#mydoc_map_status").hide(),$("#mydoc_map .alert").is(":visible")&&$("#mydoc_map .alert").removeAttr("style");(new mapboxgl.Marker).setLngLat(n).addTo(p);var o={top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38],"bottom-left":[10,-40],"bottom-right":[-10,-40],left:[8,-30],right:[-8,-30]};mydoc_map_popup_template='<span class="mydoc_id">'+c+"</span><br>"+(d+", "+l),mydoc_map_popup=new mapboxgl.Popup({offset:o,className:"mydoc-map-popup"}).setLngLat([l,d]).setHTML(mydoc_map_popup_template).addTo(p)})}else r("invalidMydoc");function r(e){var t;switch(e){case"invalidMydoc":t="<strong>DoC id not found.</strong> Please try again.";break;case"missingCoors":t="<strong>Can't map this Dose ID.</strong> Seems to be from lack of coordinates. Sorry about that... =/";break;default:t="<strong>Can't map this Dose ID.</strong> Looks like that's all the info there is. Sorry about that... =/"}if(o.loadMap().on("load",function(){console.log("findMyDoC mydoc_map.on(load) - invalid id"),$("#mydoc_map_status").hide(),$("#mydoc_map .alert").is(":visible")&&$("#mydoc_map .alert").removeAttr("style")}),$("#mydoc_map").append('<div class="alert alert-danger alert-dismissible fade show" role="alert">'+t+'<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'),console.log("$(#mydoc_map_status).is(:visible): "+$("#mydoc_map_status").is(":visible")),$("#mydoc_map_status").is(":visible")){let o=$("#mydoc_map_status").outerHeight();$("#mydoc_map .alert:first").css("margin-top",o+16+"px")}}})}}).init();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm15LmpzIl0sIm5hbWVzIjpbIm15ZG9jIiwiaW5pdCIsIm1hcGJveGdsIiwiYWNjZXNzVG9rZW4iLCJteWRvY19pZF9xdWVyeVN0cl92YWwiLCIkIiwidXJsUGFyYW0iLCJjb25zb2xlIiwibG9nIiwibG9hZE1hcCIsIm9uIiwiaGlkZSIsImlzIiwicmVtb3ZlQXR0ciIsInZhbCIsInByb3AiLCJmaW5kTXlEb0MiLCJteWRvY19pZF9zZWFyY2hfdmFsIiwidGhpcyIsInRyaW0iLCJsZW5ndGgiLCJvZmYiLCJrZXlwcmVzcyIsImUiLCJ3aGljaCIsImNsaWNrIiwic2V0dGluZ3MiLCJzaG93IiwiY2VudGVyIiwiem9vbSIsIk1hcCIsImNvbnRhaW5lciIsInN0eWxlIiwic291cmNlIiwiYWxlcnQiLCJsb2NhdGlvbiIsImhyZWYiLCJpbmRleE9mIiwiaGlzdG9yeSIsInB1c2hTdGF0ZSIsImRvY3VtZW50IiwidGl0bGUiLCJ3aW5kb3ciLCJwYXRobmFtZSIsInRvTG93ZXJDYXNlIiwiYWpheCIsInVybCIsImRhdGFUeXBlIiwiZG9uZSIsInJlc3AiLCJteWRvY19pZCIsIm15ZG9jX2RhdGEiLCJmaWVsZHMiLCJ2aWRlb3MiLCJ2aWRlb3NBcnIiLCJzcGxpdCIsImVhY2giLCJpZHgiLCJpdG0iLCJ2aWRTdmMiLCJzdWJzdHIiLCJ2aWRPYmoiLCJ2aWRJZCIsImFwcGVuZCIsImh0bWwiLCJwaG90b3MiLCJwaG90b3NBcnIiLCJjb2xsZWN0aW9uX2RhdGUiLCJsYXRpdHVkZSIsIm15ZG9jX2xhdCIsImxvbmdpdHVkZSIsIm15ZG9jX2xvbmciLCJtYXBwaW5nRXJyIiwibXlkb2NfbG9jX21iIiwibXlkb2NfbWFwIiwiTWFya2VyIiwic2V0TG5nTGF0IiwiYWRkVG8iLCJwb3B1cE9mZnNldHMiLCJ0b3AiLCJ0b3AtbGVmdCIsInRvcC1yaWdodCIsImJvdHRvbSIsImJvdHRvbS1sZWZ0IiwiYm90dG9tLXJpZ2h0IiwibGVmdCIsInJpZ2h0IiwibXlkb2NfbWFwX3BvcHVwX3RlbXBsYXRlIiwibXlkb2NfbWFwX3BvcHVwIiwiUG9wdXAiLCJvZmZzZXQiLCJjbGFzc05hbWUiLCJzZXRIVE1MIiwiY29uZGl0aW9uIiwiZXJyTXNnIiwibWFwU3RhdHVzX2giLCJvdXRlckhlaWdodCIsImNzcyJdLCJtYXBwaW5ncyI6IkFBQ0EsSUFBSUEsRUFBNkIsaUJBQVosRUFBeUJBLEVBQVEsSUFDckRBLEVBQVEsQ0FDUkMsS0FBTyxXQUNOQyxTQUFTQyxZQUFjLDZGQUN2QixJQUFJQyxFQUF3QkMsRUFBRUMsU0FBUyxXQUl2QyxHQUZBQyxRQUFRQyxJQUFJLDBCQUE0QkosSUFFVCxJQUExQkEsRUFBa0MsQ0FDdEJKLEVBQU1TLFVBRVpDLEdBQUcsT0FBUSxXQUNwQkwsRUFBRSxxQkFBcUJNLE9BRWxCTixFQUFFLHFCQUFxQk8sR0FBRyxhQUM5QlAsRUFBRSxxQkFBcUJRLFdBQVcsZ0JBSXBDUixFQUFFLDBCQUEwQlMsSUFBSVYsR0FFaENDLEVBQUUsdUJBQXVCVSxLQUFLLFlBQVksR0FFMUNmLEVBQU1nQixVQUFVLE9BR2pCWCxFQUFFLDBCQUEwQkssR0FBRyxRQUFTLFdBQ3ZDLElBQUlPLEVBQXNCWixFQUFFYSxNQUFNSixPQUNqQ0csRUFBc0JaLEVBQUVjLEtBQUtGLElBRU5HLE9BQVMsR0FDaENmLEVBQUUsdUJBQXVCVSxLQUFLLFlBQVksR0FDMUNWLEVBQUUsMEJBQTBCZ0IsSUFBSSxZQUNoQ2hCLEVBQUUsMEJBQTBCaUIsU0FBVSxTQUFVQyxHQUMvQixLQUFaQSxFQUFFQyxPQUNMeEIsRUFBTWdCLFVBQVUsWUFJbEJYLEVBQUUsdUJBQXVCVSxLQUFLLFlBQVksR0FDMUNWLEVBQUUsMEJBQTBCZ0IsSUFBSSxlQUlsQ2hCLEVBQUUsdUJBQXVCb0IsTUFBTyxXQUMvQnpCLEVBQU1nQixVQUFVLFdBSWxCUCxRQUFVLFNBQVVpQixHQUNuQnJCLEVBQUUscUJBQXFCc0IsT0FFdkIsSUFBSUMsRUFBUyxFQUFFLFdBQVksSUFDdkJDLEVBQU8sSUFxQlgsWUFuQndCLElBQWJILFNBRXFCLElBQXBCQSxFQUFTRSxTQUNuQkEsRUFBU0YsRUFBU0UsYUFJVSxJQUFsQkYsRUFBU0csT0FDbkJBLEVBQU9ILEVBQVNHLE9BSUYsSUFBSTNCLFNBQVM0QixJQUFJLENBQ2hDQyxVQUFXLFlBQ1hDLE1BQU8scURBQ1BKLE9BQVFBLEVBQ1JDLEtBQU1BLEtBTVJiLFVBQVksU0FBVWlCLEdBR3JCLElBQUloQixFQUVKLE9BSkFaLEVBQUUscUJBQXFCNkIsTUFBTSxTQUlyQkQsR0FDUCxJQUFLLE9BRUoxQixRQUFRQyxJQUFJLGlCQUlNLElBRkgyQixTQUFTQyxLQUFLQyxRQUFRLE1BR3BDQyxRQUFRQyxVQUFVLEdBQUlDLFNBQVNDLE1BQU9DLE9BQU9QLFNBQVNRLFVBR3ZEMUIsRUFBc0JaLEVBQUUsMEJBQTBCUyxNQUNsREcsRUFBc0JaLEVBQUVjLEtBQUtGLEdBQzlCLE1BQ0EsSUFBSyxNQUVKVixRQUFRQyxJQUFJLGVBRVosSUFBSUosRUFBd0JDLEVBQUVDLFNBQVMsV0FDdkNXLEVBQXNCYixFQUd4QmEsRUFBc0JBLEVBQW9CMkIsY0FFMUN2QyxFQUFFd0MsS0FBSyxDQUNOQyxJQUFLLHdDQUEwQzdCLEVBQy9DOEIsU0FBVSxTQUNSQyxLQUFNLFNBQVVDLEdBS2xCLEdBSEExQyxRQUFRQyxJQUFJLFVBQ1pELFFBQVFDLElBQUl5QyxHQUVSQSxFQUFLN0IsT0FBUyxFQUFHLENBQ3BCLElBQUk4QixFQUFXakMsRUFDZixJQUFJa0MsRUFBYUYsRUFBSyxHQUFHRyxPQU96QixHQUxBN0MsUUFBUUMsSUFBSTJDLEdBR1piLFFBQVFDLFVBQVUsR0FBSUMsU0FBU0MsTUFBTyxZQUFjUyxHQUVoREMsRUFBV0UsT0FBUSxDQUN0QixJQUFJQyxFQUFZSCxFQUFXRSxPQUMxQkMsRUFBWUEsRUFBVUMsTUFBTSxLQUU3QmxELEVBQUVtRCxLQUFLRixFQUFXLFNBQVVHLEVBQUtDLEdBQ2hDLElBQUlDLEVBQVNELEVBQUlFLE9BQU8sRUFBR0YsRUFBSXJCLFFBQVEsTUFDdkMsSUFDSXdCLEVBREFDLEVBQVFKLEVBQUlFLE9BQU9GLEVBQUlyQixRQUFRLEtBQUssRUFBR3FCLEVBQUl0QyxRQUcvQyxPQUFRdUMsR0FDUCxJQUFLLFFBQ0pFLEVBQVMsK0NBQWlEQyxFQUFRLHlGQU9wRXpELEVBQUUsbUNBQW1DMEQsT0FBT0YsVUFHN0N4RCxFQUFFLG1DQUFtQzJELEtBQUssSUFVM0MsR0FBSWIsRUFBV2MsT0FBUSxDQUN0QixJQUFJQyxFQUFZZixFQUFXYyxPQUMxQkMsRUFBWUEsRUFBVVgsTUFBTSxLQU85QixHQUFJSixFQUFXZ0IsZ0JBQ09oQixFQUFXZ0IsZ0JBS2pDLEdBQUloQixFQUFXaUIsU0FDZCxJQUFJQyxFQUFZbEIsRUFBV2lCLFNBRzVCLEdBQUlqQixFQUFXbUIsVUFDZCxJQUFJQyxFQUFhcEIsRUFBV21CLFVBRzdCLElBQUtuQixFQUFXaUIsV0FBYWpCLEVBQVdtQixVQUd2QyxZQUZBRSxFQUFXLGdCQUtaLElBQUlDLEVBQWUsQ0FBQ0YsRUFBWUYsR0FFNUIzQyxFQUFXLENBQ2RFLE9BQVE2QyxFQUNSNUMsS0FBTSxJQUdINkMsRUFBWTFFLEVBQU1TLFFBQVFpQixHQUU5QmdELEVBQVVoRSxHQUFHLE9BQVEsV0FDcEJMLEVBQUUscUJBQXFCTSxPQUVsQk4sRUFBRSxxQkFBcUJPLEdBQUcsYUFDOUJQLEVBQUUscUJBQXFCUSxXQUFXLFVBR2hCLElBQUlYLFNBQVN5RSxRQUFTQyxVQUFVSCxHQUFjSSxNQUFNSCxHQUV2RSxJQUlJSSxFQUFlLENBQ2xCQyxJQUFPLENBQUMsRUFBRyxHQUNYQyxXQUFZLENBQUMsRUFBRSxHQUNmQyxZQUFhLENBQUMsRUFBRSxHQUNoQkMsT0FBVSxDQUFDLEdBUk8sSUFTbEJDLGNBQWUsQ0FQQSxJQU9lLElBQzlCQyxlQUFnQixFQVJELElBUWlCLElBQ2hDQyxLQUFRLENBVk8sR0FVUSxJQUN2QkMsTUFBUyxFQVhNLEdBV1UsS0FLMUJDLHlCQUEyQiwwQkFBNEJyQyxFQUFXLGVBRjlDbUIsRUFBWSxLQUFPRSxHQVN2Q2lCLGdCQUFrQixJQUFJdEYsU0FBU3VGLE1BQU0sQ0FBQ0MsT0FBUVosRUFBY2EsVUFBVyxvQkFDckVmLFVBQVUsQ0FBQ0wsRUFBWUYsSUFDdkJ1QixRQUFRTCwwQkFDUlYsTUFBTUgsVUFHVEYsRUFBVyxnQkFHWixTQUFTQSxFQUFZcUIsR0FDcEIsSUFBSUMsRUFFSixPQUFRRCxHQUNQLElBQUssZUFDSkMsRUFBUyx1REFDVixNQUNBLElBQUssZUFDSkEsRUFBUyx3R0FDVixNQUNBLFFBQ0NBLEVBQVMsMkdBb0JYLEdBakJnQjlGLEVBQU1TLFVBRVpDLEdBQUcsT0FBUSxXQUVwQkgsUUFBUUMsSUFBSSw2Q0FFWkgsRUFBRSxxQkFBcUJNLE9BRWxCTixFQUFFLHFCQUFxQk8sR0FBRyxhQUM5QlAsRUFBRSxxQkFBcUJRLFdBQVcsV0FJcENSLEVBQUUsY0FBYzBELE9BQU8sNEVBQThFK0IsRUFBUyxzSUFFOUd2RixRQUFRQyxJQUFLLHNDQUF5Q0gsRUFBRSxxQkFBcUJPLEdBQUcsYUFFM0VQLEVBQUUscUJBQXFCTyxHQUFHLFlBQWMsQ0FDNUMsSUFBSW1GLEVBQWMxRixFQUFFLHFCQUFxQjJGLGNBRXpDM0YsRUFBRSwyQkFBMkI0RixJQUFJLGFBQWNGLEVBQWMsR0FBSyxhQVVwRTlGIiwiZmlsZSI6Im15Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKiBteS5qcyAqL1xyXG52YXIgbXlkb2MgPSAoIHR5cGVvZiAobXlkb2MpID09PSAnb2JqZWN0JyApID8gbXlkb2MgOiB7fTtcclxuKG15ZG9jID0ge1xyXG5cdGluaXQgOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRtYXBib3hnbC5hY2Nlc3NUb2tlbiA9ICdway5leUoxSWpvaWRHaGhkR0p5WVcwaUxDSmhJam9pWTJwMFl6TTFOVzl6TUhNNU1UTjVjRFJzZG5Kb09HdzNieUo5LkE3dW1aVnQ5U3g3TmI4amZONk0wM2cnO1xyXG5cdFx0bGV0IG15ZG9jX2lkX3F1ZXJ5U3RyX3ZhbCA9ICQudXJsUGFyYW0oJ215ZG9jaWQnKTtcclxuXHJcblx0XHRjb25zb2xlLmxvZygnbXlkb2NfaWRfcXVlcnlTdHJfdmFsOiAnICsgbXlkb2NfaWRfcXVlcnlTdHJfdmFsKTtcclxuXHJcblx0XHRpZiAoIG15ZG9jX2lkX3F1ZXJ5U3RyX3ZhbCA9PT0gZmFsc2UgKSB7XHJcblx0XHRcdGxldCBteWRvY19tYXAgPSBteWRvYy5sb2FkTWFwKCk7XHJcblxyXG5cdFx0XHRteWRvY19tYXAub24oJ2xvYWQnLCBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0JCgnI215ZG9jX21hcF9zdGF0dXMnKS5oaWRlKCk7XHJcblxyXG5cdFx0XHRcdGlmICggJCgnI215ZG9jX21hcCAuYWxlcnQnKS5pcygnOnZpc2libGUnKSApIHtcclxuXHRcdFx0XHRcdCQoJyNteWRvY19tYXAgLmFsZXJ0JykucmVtb3ZlQXR0cignc3R5bGUnKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0JCgnI215ZG9jX2lkX3NlYXJjaF9maWVsZCcpLnZhbChteWRvY19pZF9xdWVyeVN0cl92YWwpO1xyXG5cclxuXHRcdFx0JCgnI215ZG9jX2lkX3NlYXJjaF9nbycpLnByb3AoJ2Rpc2FibGVkJywgdHJ1ZSk7XHJcblxyXG5cdFx0XHRteWRvYy5maW5kTXlEb0MoJ3VybCcpO1xyXG5cdFx0fVxyXG5cclxuXHRcdCQoJyNteWRvY19pZF9zZWFyY2hfZmllbGQnKS5vbignaW5wdXQnLCBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdGxldCBteWRvY19pZF9zZWFyY2hfdmFsID0gJCh0aGlzKS52YWwoKTtcclxuXHRcdFx0XHRteWRvY19pZF9zZWFyY2hfdmFsID0gJC50cmltKG15ZG9jX2lkX3NlYXJjaF92YWwpO1xyXG5cclxuXHRcdFx0aWYgKG15ZG9jX2lkX3NlYXJjaF92YWwubGVuZ3RoID4gNCkge1xyXG5cdFx0XHRcdCQoJyNteWRvY19pZF9zZWFyY2hfZ28nKS5wcm9wKCdkaXNhYmxlZCcsIGZhbHNlKTtcclxuXHRcdFx0XHQkKCcjbXlkb2NfaWRfc2VhcmNoX2ZpZWxkJykub2ZmKCdrZXlwcmVzcycpO1xyXG5cdFx0XHRcdCQoJyNteWRvY19pZF9zZWFyY2hfZmllbGQnKS5rZXlwcmVzcyggZnVuY3Rpb24gKGUpIHtcclxuXHRcdFx0XHRcdGlmIChlLndoaWNoID09PSAxMykge1xyXG5cdFx0XHRcdFx0XHRteWRvYy5maW5kTXlEb0MoJ3VzZXInKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQkKCcjbXlkb2NfaWRfc2VhcmNoX2dvJykucHJvcCgnZGlzYWJsZWQnLCB0cnVlKTtcclxuXHRcdFx0XHQkKCcjbXlkb2NfaWRfc2VhcmNoX2ZpZWxkJykub2ZmKCdrZXlwcmVzcycpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHJcblx0XHQkKCcjbXlkb2NfaWRfc2VhcmNoX2dvJykuY2xpY2soIGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0bXlkb2MuZmluZE15RG9DKCd1c2VyJyk7XHJcblx0XHR9KTtcclxuXHR9XHJcblx0LFxyXG5cdGxvYWRNYXAgOiBmdW5jdGlvbiAoc2V0dGluZ3MpIHtcclxuXHRcdCQoJyNteWRvY19tYXBfc3RhdHVzJykuc2hvdygpO1xyXG5cclxuXHRcdHZhciBjZW50ZXIgPSBbLTEwNS41NDcyMjIsIDM5XTtcclxuXHRcdHZhciB6b29tID0gNi41O1xyXG5cclxuXHRcdGlmICh0eXBlb2Ygc2V0dGluZ3MgIT09ICd1bmRlZmluZWQnKSB7XHJcblx0XHRcdC8qKiBJZiBubyBtYXAgY2VudGVyIGlzIHNwZWNpZmllZCwgc2V0IHRvIGdlb2dyYXBoaWMgY2VudGVyIG9mIENvbG9yYWRvICovXHJcblx0XHRcdGlmICh0eXBlb2Ygc2V0dGluZ3MuY2VudGVyICE9PSAndW5kZWZpbmVkJykge1xyXG5cdFx0XHRcdGNlbnRlciA9IHNldHRpbmdzLmNlbnRlcjtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0LyoqIElmIG5vIG1hcCB6b29tIGxldmVsIGlzIHNwZWNpZmllZCwgc2V0IHRvIGEgbGV2ZWwgbWFraW5nIENvbG9yYWRvIGlkZW50aWZpYWJsZSBhY3Jvc3Mgd2lkZXN0IHZhcmlldHkgb2YgcmVzb2x1dGlvbnMgKi9cclxuXHRcdFx0aWYgKHR5cGVvZiBzZXR0aW5ncy56b29tICE9PSAndW5kZWZpbmVkJykge1xyXG5cdFx0XHRcdHpvb20gPSBzZXR0aW5ncy56b29tO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IG15ZG9jX21hcCA9IG5ldyBtYXBib3hnbC5NYXAoe1xyXG5cdFx0XHRjb250YWluZXI6ICdteWRvY19tYXAnLFxyXG5cdFx0XHRzdHlsZTogJ21hcGJveDovL3N0eWxlcy90aGF0YnJhbS9janRva2gyNjkwMmFkMWZtNDN4cW00a3YyJywgLy8gJ1JhZG8gMlxyXG5cdFx0XHRjZW50ZXI6IGNlbnRlcixcclxuXHRcdFx0em9vbTogem9vbVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0cmV0dXJuIG15ZG9jX21hcDtcclxuXHR9XHJcblx0LFxyXG5cdGZpbmRNeURvQyA6IGZ1bmN0aW9uIChzb3VyY2UpIHtcclxuXHRcdCQoJyNteWRvY19tYXAgLmFsZXJ0JykuYWxlcnQoJ2Nsb3NlJyk7XHJcblxyXG5cdFx0bGV0IG15ZG9jX2lkX3NlYXJjaF92YWw7XHJcblxyXG5cdFx0c3dpdGNoIChzb3VyY2UpIHtcclxuXHRcdFx0Y2FzZSAndXNlcic6XHJcblxyXG5cdFx0XHRcdGNvbnNvbGUubG9nKCdzb3VyY2U6IHVzZXInKTtcclxuXHJcblx0XHRcdFx0dmFyIHFTdHJfaWR4ID0gbG9jYXRpb24uaHJlZi5pbmRleE9mKCc/Jyk7XHJcblxyXG5cdFx0XHRcdGlmIChxU3RyX2lkeCAhPT0gLTEpIHtcclxuXHRcdFx0XHRcdGhpc3RvcnkucHVzaFN0YXRlKCcnLCBkb2N1bWVudC50aXRsZSwgd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lKTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdG15ZG9jX2lkX3NlYXJjaF92YWwgPSAkKCcjbXlkb2NfaWRfc2VhcmNoX2ZpZWxkJykudmFsKCk7XHJcblx0XHRcdFx0bXlkb2NfaWRfc2VhcmNoX3ZhbCA9ICQudHJpbShteWRvY19pZF9zZWFyY2hfdmFsKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgJ3VybCc6XHJcblxyXG5cdFx0XHRcdGNvbnNvbGUubG9nKCdzb3VyY2U6IHVybCcpO1xyXG5cclxuXHRcdFx0XHRsZXQgbXlkb2NfaWRfcXVlcnlTdHJfdmFsID0gJC51cmxQYXJhbSgnbXlkb2NpZCcpO1xyXG5cdFx0XHRcdG15ZG9jX2lkX3NlYXJjaF92YWwgPSBteWRvY19pZF9xdWVyeVN0cl92YWw7XHJcblx0XHR9XHJcblxyXG5cdFx0bXlkb2NfaWRfc2VhcmNoX3ZhbCA9IG15ZG9jX2lkX3NlYXJjaF92YWwudG9Mb3dlckNhc2UoKTtcclxuXHJcblx0XHQkLmFqYXgoe1xyXG5cdFx0XHR1cmw6ICcvLm5ldGxpZnkvZnVuY3Rpb25zL215ZG9jX2F0P215ZG9jaWQ9JyArIG15ZG9jX2lkX3NlYXJjaF92YWwsXHJcblx0XHRcdGRhdGFUeXBlOiAnanNvbidcclxuXHRcdH0pLmRvbmUoIGZ1bmN0aW9uIChyZXNwKSB7XHJcblxyXG5cdFx0XHRjb25zb2xlLmxvZygncmVzcDogJyk7XHJcblx0XHRcdGNvbnNvbGUubG9nKHJlc3ApO1xyXG5cclxuXHRcdFx0aWYgKHJlc3AubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdGxldCBteWRvY19pZCA9IG15ZG9jX2lkX3NlYXJjaF92YWw7XHJcblx0XHRcdFx0dmFyIG15ZG9jX2RhdGEgPSByZXNwWzBdLmZpZWxkcztcclxuXHJcblx0XHRcdFx0Y29uc29sZS5sb2cobXlkb2NfZGF0YSk7XHJcblxyXG5cdFx0XHRcdC8qKiBTZXQgZGlyZWN0bHkgYWNjZXNzaWJsZSBVUkwgKi9cclxuXHRcdFx0XHRoaXN0b3J5LnB1c2hTdGF0ZSgnJywgZG9jdW1lbnQudGl0bGUsICc/bXlkb2NpZD0nICsgbXlkb2NfaWQpO1xyXG5cclxuXHRcdFx0XHRpZiAobXlkb2NfZGF0YS52aWRlb3MpIHtcclxuXHRcdFx0XHRcdHZhciB2aWRlb3NBcnIgPSBteWRvY19kYXRhLnZpZGVvcztcclxuXHRcdFx0XHRcdFx0dmlkZW9zQXJyID0gdmlkZW9zQXJyLnNwbGl0KCcsJyk7XHJcblxyXG5cdFx0XHRcdFx0JC5lYWNoKHZpZGVvc0FyciwgZnVuY3Rpb24gKGlkeCwgaXRtKSB7XHJcblx0XHRcdFx0XHRcdGxldCB2aWRTdmMgPSBpdG0uc3Vic3RyKDAsIGl0bS5pbmRleE9mKCc6JykpO1xyXG5cdFx0XHRcdFx0XHR2YXIgdmlkSWQgPSBpdG0uc3Vic3RyKGl0bS5pbmRleE9mKCc6JykrMSwgaXRtLmxlbmd0aCk7XHJcblx0XHRcdFx0XHRcdHZhciB2aWRPYmo7XHJcblxyXG5cdFx0XHRcdFx0XHRzd2l0Y2ggKHZpZFN2Yykge1xyXG5cdFx0XHRcdFx0XHRcdGNhc2UgJ3ZpbWVvJzpcclxuXHRcdFx0XHRcdFx0XHRcdHZpZE9iaiA9ICc8aWZyYW1lIHNyYz1cImh0dHBzOi8vcGxheWVyLnZpbWVvLmNvbS92aWRlby8nICsgdmlkSWQgKyAnXCIgY2xhc3M9XCJ2aWRlb1wiIGZyYW1lYm9yZGVyPVwiMFwiIGFsbG93PVwiYXV0b3BsYXk7IGZ1bGxzY3JlZW5cIiBhbGxvd2Z1bGxzY3JlZW4+PC9pZnJhbWU+JztcclxuXHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHQvLyBjYXNlICd5b3V0dWJlJzpcclxuXHRcdFx0XHRcdFx0XHRcdC8vIHZpZE9iaiA9ICcnOyAvLyAnaHR0cHM6Ly95b3V0dWJlLmNvbS93YXRjaD92PScgKyB2aWRJZDtcclxuXHRcdFx0XHRcdFx0XHQvLyBicmVhaztcclxuXHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdFx0JCgnI215ZG9jX2RldGFpbHNfdmlkZW9zX2NvbnRhaW5lcicpLmFwcGVuZCh2aWRPYmopO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdCQoJyNteWRvY19kZXRhaWxzX3ZpZGVvc19jb250YWluZXInKS5odG1sKCcnKTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdC8qKiBcclxuXHRcdFx0XHQgKiBGb3IgaW1hZ2UgZGlzcGxheS9jYXJvdXNlbCwgdXNlIG5hbWluZyBjb252ZW50aW9uLCBmb3IgZXhhbXBsZTpcclxuXHRcdFx0XHQgKiAtIGFscGhhMDEuanBnLCBhbHBoYTAyLmpwZ1xyXG5cdFx0XHRcdCAqIG9yXHJcblx0XHRcdFx0ICogLSAvYWxwaGEvMDEuanBnLCAvYWxwaGEvMDIuanBnXHJcblx0XHRcdFx0ICovXHJcblxyXG5cdFx0XHRcdGlmIChteWRvY19kYXRhLnBob3Rvcykge1xyXG5cdFx0XHRcdFx0dmFyIHBob3Rvc0FyciA9IG15ZG9jX2RhdGEucGhvdG9zO1xyXG5cdFx0XHRcdFx0XHRwaG90b3NBcnIgPSBwaG90b3NBcnIuc3BsaXQoJywnKTtcclxuXHJcblx0XHRcdFx0XHQvKiQuZWFjaChwaG90b3NBcnIsIGZ1bmN0aW9uIChpZHgsIGl0bSkge1xyXG5cdFx0XHRcdFx0XHQvL1xyXG5cdFx0XHRcdFx0fSk7Ki9cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGlmIChteWRvY19kYXRhLmNvbGxlY3Rpb25fZGF0ZSkge1xyXG5cdFx0XHRcdFx0dmFyIG15ZG9jX2NvbGxEYXRlID0gbXlkb2NfZGF0YS5jb2xsZWN0aW9uX2RhdGU7XHJcblxyXG5cdFx0XHRcdFx0Ly8gRG8gdGhlIGRhdGUgc3R1ZmZcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGlmIChteWRvY19kYXRhLmxhdGl0dWRlKSB7XHJcblx0XHRcdFx0XHR2YXIgbXlkb2NfbGF0ID0gbXlkb2NfZGF0YS5sYXRpdHVkZTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGlmIChteWRvY19kYXRhLmxvbmdpdHVkZSkge1xyXG5cdFx0XHRcdFx0dmFyIG15ZG9jX2xvbmcgPSBteWRvY19kYXRhLmxvbmdpdHVkZTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGlmICghbXlkb2NfZGF0YS5sYXRpdHVkZSB8fCAhbXlkb2NfZGF0YS5sb25naXR1ZGUpIHtcclxuXHRcdFx0XHRcdG1hcHBpbmdFcnIoJ21pc3NpbmdDb29ycycpO1xyXG5cclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0bGV0IG15ZG9jX2xvY19tYiA9IFtteWRvY19sb25nLCBteWRvY19sYXRdO1xyXG5cclxuXHRcdFx0XHRsZXQgc2V0dGluZ3MgPSB7XHJcblx0XHRcdFx0XHRjZW50ZXI6IG15ZG9jX2xvY19tYixcclxuXHRcdFx0XHRcdHpvb206IDE1XHJcblx0XHRcdFx0fTtcclxuXHJcblx0XHRcdFx0bGV0IG15ZG9jX21hcCA9IG15ZG9jLmxvYWRNYXAoc2V0dGluZ3MpO1xyXG5cclxuXHRcdFx0XHRteWRvY19tYXAub24oJ2xvYWQnLCBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0XHQkKCcjbXlkb2NfbWFwX3N0YXR1cycpLmhpZGUoKTtcclxuXHJcblx0XHRcdFx0XHRpZiAoICQoJyNteWRvY19tYXAgLmFsZXJ0JykuaXMoJzp2aXNpYmxlJykgKSB7XHJcblx0XHRcdFx0XHRcdCQoJyNteWRvY19tYXAgLmFsZXJ0JykucmVtb3ZlQXR0cignc3R5bGUnKTtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRsZXQgbXlkb2NfbWFya2VyID0gbmV3IG1hcGJveGdsLk1hcmtlcigpLnNldExuZ0xhdChteWRvY19sb2NfbWIpLmFkZFRvKG15ZG9jX21hcCk7XHJcblxyXG5cdFx0XHRcdFx0dmFyIG1hcmtlckhlaWdodCA9IDM4LFxyXG5cdFx0XHRcdFx0XHRtYXJrZXJSYWRpdXMgPSA4LFxyXG5cdFx0XHRcdFx0XHRsaW5lYXJPZmZzZXQgPSAxMDtcclxuXHJcblx0XHRcdFx0XHR2YXIgcG9wdXBPZmZzZXRzID0ge1xyXG5cdFx0XHRcdFx0XHQndG9wJzogWzAsIDBdLFxyXG5cdFx0XHRcdFx0XHQndG9wLWxlZnQnOiBbMCwwXSxcclxuXHRcdFx0XHRcdFx0J3RvcC1yaWdodCc6IFswLDBdLFxyXG5cdFx0XHRcdFx0XHQnYm90dG9tJzogWzAsIC1tYXJrZXJIZWlnaHRdLFxyXG5cdFx0XHRcdFx0XHQnYm90dG9tLWxlZnQnOiBbbGluZWFyT2Zmc2V0LCAobWFya2VySGVpZ2h0IC0gbWFya2VyUmFkaXVzICsgbGluZWFyT2Zmc2V0KSAqIC0xXSxcclxuXHRcdFx0XHRcdFx0J2JvdHRvbS1yaWdodCc6IFstbGluZWFyT2Zmc2V0LCAobWFya2VySGVpZ2h0IC0gbWFya2VyUmFkaXVzICsgbGluZWFyT2Zmc2V0KSAqIC0xXSxcclxuXHRcdFx0XHRcdFx0J2xlZnQnOiBbbWFya2VyUmFkaXVzLCAobWFya2VySGVpZ2h0IC0gbWFya2VyUmFkaXVzKSAqIC0xXSxcclxuXHRcdFx0XHRcdFx0J3JpZ2h0JzogWy1tYXJrZXJSYWRpdXMsIChtYXJrZXJIZWlnaHQgLSBtYXJrZXJSYWRpdXMpICogLTFdXHJcblx0XHRcdFx0XHR9O1xyXG5cclxuXHRcdFx0XHRcdGxldCBteWRvY19sb2Nfc3RyID0gbXlkb2NfbGF0ICsgJywgJyArIG15ZG9jX2xvbmc7XHJcblxyXG5cdFx0XHRcdFx0bXlkb2NfbWFwX3BvcHVwX3RlbXBsYXRlID0gJzxzcGFuIGNsYXNzPVwibXlkb2NfaWRcIj4nICsgbXlkb2NfaWQgKyAnPC9zcGFuPidcclxuXHRcdFx0XHRcdFx0KyAnPGJyPidcclxuXHRcdFx0XHRcdFx0KyBteWRvY19sb2Nfc3RyXHJcblx0XHRcdFx0XHRcdC8vICsgJzxicj4nXHJcblx0XHRcdFx0XHRcdC8vICsgJzxhIGhyZWY9XCIjbXlkb2NfZGV0YWlsc1wiPkRldGFpbHM8L2E+J1xyXG5cdFx0XHRcdFx0O1xyXG5cclxuXHRcdFx0XHRcdG15ZG9jX21hcF9wb3B1cCA9IG5ldyBtYXBib3hnbC5Qb3B1cCh7b2Zmc2V0OiBwb3B1cE9mZnNldHMsIGNsYXNzTmFtZTogJ215ZG9jLW1hcC1wb3B1cCd9KVxyXG5cdFx0XHRcdFx0XHQuc2V0TG5nTGF0KFtteWRvY19sb25nLCBteWRvY19sYXRdKVxyXG5cdFx0XHRcdFx0XHQuc2V0SFRNTChteWRvY19tYXBfcG9wdXBfdGVtcGxhdGUpXHJcblx0XHRcdFx0XHRcdC5hZGRUbyhteWRvY19tYXApO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdG1hcHBpbmdFcnIoJ2ludmFsaWRNeWRvYycpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRmdW5jdGlvbiBtYXBwaW5nRXJyIChjb25kaXRpb24pIHtcclxuXHRcdFx0XHR2YXIgZXJyTXNnO1xyXG5cclxuXHRcdFx0XHRzd2l0Y2ggKGNvbmRpdGlvbikge1xyXG5cdFx0XHRcdFx0Y2FzZSAnaW52YWxpZE15ZG9jJzpcclxuXHRcdFx0XHRcdFx0ZXJyTXNnID0gJzxzdHJvbmc+RG9DIGlkIG5vdCBmb3VuZC48L3N0cm9uZz4gUGxlYXNlIHRyeSBhZ2Fpbi4nO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlICdtaXNzaW5nQ29vcnMnOlxyXG5cdFx0XHRcdFx0XHRlcnJNc2cgPSAnPHN0cm9uZz5DYW5cXCd0IG1hcCB0aGlzIERvc2UgSUQuPC9zdHJvbmc+IFNlZW1zIHRvIGJlIGZyb20gbGFjayBvZiBjb29yZGluYXRlcy4gU29ycnkgYWJvdXQgdGhhdC4uLiA9Lyc7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdGRlZmF1bHQ6XHJcblx0XHRcdFx0XHRcdGVyck1zZyA9ICc8c3Ryb25nPkNhblxcJ3QgbWFwIHRoaXMgRG9zZSBJRC48L3N0cm9uZz4gTG9va3MgbGlrZSB0aGF0XFwncyBhbGwgdGhlIGluZm8gdGhlcmUgaXMuIFNvcnJ5IGFib3V0IHRoYXQuLi4gPS8nO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGxldCBteWRvY19tYXAgPSBteWRvYy5sb2FkTWFwKCk7XHJcblxyXG5cdFx0XHRcdG15ZG9jX21hcC5vbignbG9hZCcsIGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHRcdFx0XHRjb25zb2xlLmxvZygnZmluZE15RG9DIG15ZG9jX21hcC5vbihsb2FkKSAtIGludmFsaWQgaWQnKTtcclxuXHJcblx0XHRcdFx0XHQkKCcjbXlkb2NfbWFwX3N0YXR1cycpLmhpZGUoKTtcclxuXHJcblx0XHRcdFx0XHRpZiAoICQoJyNteWRvY19tYXAgLmFsZXJ0JykuaXMoJzp2aXNpYmxlJykgKSB7XHJcblx0XHRcdFx0XHRcdCQoJyNteWRvY19tYXAgLmFsZXJ0JykucmVtb3ZlQXR0cignc3R5bGUnKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0JCgnI215ZG9jX21hcCcpLmFwcGVuZCgnPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LWRhbmdlciBhbGVydC1kaXNtaXNzaWJsZSBmYWRlIHNob3dcIiByb2xlPVwiYWxlcnRcIj4nICsgZXJyTXNnICsgJzxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiY2xvc2VcIiBkYXRhLWRpc21pc3M9XCJhbGVydFwiIGFyaWEtbGFiZWw9XCJDbG9zZVwiPjxzcGFuIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPiZ0aW1lczs8L3NwYW4+PC9idXR0b24+PC9kaXY+Jyk7XHJcblxyXG5cdFx0XHRcdGNvbnNvbGUubG9nKCAnJCgjbXlkb2NfbWFwX3N0YXR1cykuaXMoOnZpc2libGUpOiAnICsgICQoJyNteWRvY19tYXBfc3RhdHVzJykuaXMoJzp2aXNpYmxlJykgKTtcclxuXHJcblx0XHRcdFx0aWYgKCAkKCcjbXlkb2NfbWFwX3N0YXR1cycpLmlzKCc6dmlzaWJsZScpICkge1xyXG5cdFx0XHRcdFx0bGV0IG1hcFN0YXR1c19oID0gJCgnI215ZG9jX21hcF9zdGF0dXMnKS5vdXRlckhlaWdodCgpO1xyXG5cclxuXHRcdFx0XHRcdCQoJyNteWRvY19tYXAgLmFsZXJ0OmZpcnN0JykuY3NzKCdtYXJnaW4tdG9wJywgbWFwU3RhdHVzX2ggKyAxNiArICdweCcpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0LyoqIEF1dG9jbG9zZSB0aGUgYWxlcnRzICovXHJcblx0XHRcdFx0Lyp3aW5kb3cuc2V0VGltZW91dCggZnVuY3Rpb24gKCkge1xyXG5cdFx0ICAgICAgICAgICAgJCgnI215ZG9jX21hcCAuYWxlcnQnKS5hbGVydCgnY2xvc2UnKTtcclxuXHRcdCAgICAgICAgfSwgNDAwMCk7Ki9cclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59KS5pbml0KCk7XHJcbiJdfQ==
